<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ruby | hnakamur's blog at github]]></title>
  <link href="http://hnakamur.github.com/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://hnakamur.github.com/blog/"/>
  <updated>2013-03-12T23:20:19+09:00</updated>
  <id>http://hnakamur.github.com/blog/</id>
  <author>
    <name><![CDATA[Hiroaki Nakamura]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[lua, V8, ruby, mrubyでfib(39)の実行時間比較]]></title>
    <link href="http://hnakamur.github.com/blog/2013/03/12/fib-39-benchmark-in-luajit/"/>
    <updated>2013-03-12T14:20:00+09:00</updated>
    <id>http://hnakamur.github.com/blog/2013/03/12/fib-39-benchmark-in-luajit</id>
    <content type="html"><![CDATA[<p><a href="http://hnakamur.github.com/blog/2012/05/04/fib-39-benchmark-in-lua/">lua, V8, ruby, mrubyでfib(39)の実行時間比較 - hnakamur's blog at github</a>が<a href="https://twitter.com/yukihiro_matz">@matz</a>さんにツイートされたのを受けて、各処理系の最新版で再度試してみました。</p>

<p>テスト環境（前回とは違う環境です）</p>

<ul>
<li>Model: MacBook Pro Retina, Mid 2012</li>
<li>CPU: 2.6GHz Intel Core i7</li>
<li>RAM: 16GB 1600MHz DDR3</li>
<li>OS: Mac OS X 10.8.2</li>
</ul>


<h2>lua</h2>

<p>```
function fib(n)
  if n &lt; 2 then</p>

<pre><code>return n
</code></pre>

<p>  end
  return fib(n-2) + fib(n-1)
end</p>

<p>print(fib(39))
```</p>

<p>```
$ luajit -v
LuaJIT 2.0.1 -- Copyright (C) 2005-2013 Mike Pall. http://luajit.org/
$ time luajit fib.lua
63245986</p>

<p>real  0m0.906s
user  0m0.901s
sys 0m0.003s
```</p>

<p>```
$ lua -v
Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio
$ time lua fib.lua
63245986</p>

<p>real  0m12.278s
user  0m12.271s
sys 0m0.006s
```</p>

<p>```
$ src/lua -v
Lua 5.2.1  Copyright (C) 1994-2012 Lua.org, PUC-Rio
$ time src/lua ~/bench/fib.lua
63245986</p>

<p>real  0m13.971s
user  0m13.965s
sys 0m0.005s
```</p>

<h2>v8</h2>

<p>```
function fib(n) {
  if (n &lt; 2) return n;
  return fib(n-2) + fib(n-1);
}</p>

<p>print(fib(39));
```</p>

<p>```
$ v8
V8 version 3.16.14 [sample shell]</p>

<blockquote><p>^D
$ time v8 fib.js
63245986</p></blockquote>

<p>real  0m0.804s
user  0m0.798s
sys 0m0.008s
```</p>

<h2>ruby</h2>

<p>```
def fib n
  return n if n &lt; 2
  fib(n-2) + fib(n-1)
end</p>

<p>puts fib(39)
```</p>

<p>```
$ git log -1 | grep commit
commit 46d8c51763bd13b69a4234f0d4be05cbfd8ae401</p>

<p>$ time bin/mruby fib.rb
63245986</p>

<p>real  0m16.357s
user  0m16.345s
sys 0m0.008s
```</p>

<p>```
$ rbenv version
1.9.3-p374 (set by /Users/hnakamur/.rbenv/version)
$ time ruby fib.rb
63245986</p>

<p>real  0m16.225s
user  0m16.169s
sys 0m0.043s
```</p>

<p>```
$ rbenv version
1.9.3-p392 (set by /Users/hnakamur/.rbenv/version)
$ time ruby fib.rb
63245986</p>

<p>real  0m36.813s
user  0m36.746s
sys 0m0.043s
```</p>

<p>```
$ rbenv version
2.0.0-p0 (set by /Users/hnakamur/.rbenv/version)
$ time ruby fib.rb
63245986</p>

<p>real  0m31.828s
user  0m31.743s
sys 0m0.045s
```</p>

<h3>2013-03-12 23:15 追記</h3>

<p>1.9.3-p374と1.9.3-p392でこんなに違うのは変だなと思って、1.9.3-p374を入れなおして再度測ってみました。</p>

<p>```
$ rbenv version
1.9.3-p374 (set by /Users/hnakamur/.rbenv/version)
sunshine5:versions hnakamur$ time ruby ~/bench/fib.rb
63245986</p>

<p>real  0m38.909s
user  0m38.834s
sys 0m0.045s
```</p>

<p>以前1.9.3-p374を入れた時から、XCodeのバージョンが変わっているので、コンパイラが違うせいで大幅に時間が変わったようです。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[lua, V8, ruby, mrubyでfib(39)の実行時間比較 2013-03-12版]]></title>
    <link href="http://hnakamur.github.com/blog/2012/05/04/fib-39-benchmark-in-lua/"/>
    <updated>2012-05-04T11:06:00+09:00</updated>
    <id>http://hnakamur.github.com/blog/2012/05/04/fib-39-benchmark-in-lua</id>
    <content type="html"><![CDATA[<p>2013-03-13追記</p>

<p>この記事が<a href="https://twitter.com/yukihiro_matz">@matz</a>さんにツイートされたのを受けて、各処理系の最新版で再度試してみました。
<a href="http://hnakamur.github.com/blog/2013/03/12/fib-39-benchmark-in-luajit/">lua, V8, ruby, mrubyでfib(39)の実行時間比較 2013-03-12版</a>をご参照ください。</p>

<hr>


<p><a href="http://www.quredo.net/2012/04/mruby-%E8%BB%BD%E9%87%8Fruby-%E3%82%BD%E3%83%BC%E3%82%B9%E5%85%AC%E9%96%8B/">mruby (軽量ruby) ソース公開 | quredo-style</a>を見て、自分の環境でlua, luajit, V8, ruby, mrubyで試してみた。</p>

<p>テスト環境</p>

<ul>
<li>Model: MacBook Air 13-inch, Mid 2011</li>
<li>CPU: 1.7GHz Intel Core i5</li>
<li>RAM: 4GB 1333MHz DDR3</li>
<li>OS: Mac OS X Lion 10.7.3</li>
</ul>


<h2>lua</h2>

<p>fib.lua
```
function fib(n)
  if n &lt; 2 then</p>

<pre><code>return n
</code></pre>

<p>  end
  return fib(n-2) + fib(n-1)
end</p>

<p>print(fib(39))
```</p>

<p>```
$ lua -v
Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
$ time lua fib.lua
63245986</p>

<p>real    0m21.368s
user    0m21.345s
sys 0m0.016s
```</p>

<p>```
$ ./lua -v
Lua 5.2.0  Copyright (C) 1994-2011 Lua.org, PUC-Rio
$ time ./lua fib.lua
63245986</p>

<p>real    0m19.603s
user    0m19.585s
sys 0m0.012s
```</p>

<p>```
$ ./luajit -v
Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio
LuaJIT 1.1.8  Copyright (C) 2005-2012 Mike Pall, http://luajit.org/
$ time ./luajit fib.lua
63245986</p>

<p>real    0m4.302s
user    0m4.292s
sys 0m0.006s
```</p>

<p>```
$ luajit -v
LuaJIT 2.0.0-beta9 -- Copyright (C) 2005-2011 Mike Pall. http://luajit.org/
$ time luajit fib.lua
63245986</p>

<p>real    0m1.299s
user    0m1.289s
sys 0m0.004s
```</p>

<h2>V8</h2>

<p>```
function fib(n) {
  if (n &lt; 2) return n;
  return fib(n-2) + fib(n-1);
}</p>

<p>print(fib(39));
```</p>

<p>```
$ v8
V8 version 3.9.24 [sample shell]</p>

<blockquote><p>quit()
$ time v8 fib.js
63245986</p></blockquote>

<p>real    0m1.417s
user    0m1.407s
sys 0m0.013s
```</p>

<h2>ruby</h2>

<p>```
def fib n
  return n if n &lt; 2
  fib(n-2) + fib(n-1)
end</p>

<p>puts fib(39)
```</p>

<p>```
$ rbenv version
1.8.7-p358 (set by /Users/hnakamur/.rbenv/version)
$ time ruby fib.rb
63245986</p>

<p>real    1m47.227s
user    1m46.945s
sys 0m0.132s
```</p>

<p>```
$ rbenv version
1.9.3-p125 (set by /Users/hnakamur/.rbenv/version)
$ time ruby fib.rb
63245986</p>

<p>real    0m16.504s
user    0m16.374s
sys 0m0.051s
```</p>

<p>```
$ time bin/mruby fib.rb
63245986</p>

<p>real    0m35.465s
user    0m35.423s
sys 0m0.014s
```</p>

<p>[2012-05-03 23:21]</p>
]]></content>
  </entry>
  
</feed>
