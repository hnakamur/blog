<!DOCTYPE html>
<html lang="ja">
<head>
        <meta charset="utf-8" />
        <title>LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました</title>
        <link rel="stylesheet" href="../../../../../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../../../../../">hnakamur's blog at github </a></h1>
                <nav><ul>
                    <li class="active"><a href="../../../../../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="../../../../../blog/2015/04/23/try-lxd-0.7-with-vagrant/" rel="bookmark"
           title="Permalink to LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました">LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-04-23T00:08:00+09:00">
                Published: 2015-04-23
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://hnakamur.github.io">Hiroaki Nakamura</a>
        </address>
<p>In <a href="../../../../../category/blog.html">blog</a>.</p>
<p>tags: <a href="../../../../../tag/lxd.html">lxd</a> </p>
</footer><!-- /.post-info -->      <h2>はじめに</h2>
<p><a href="/blog/2014/12/01/lxd-the-linux-container-daemon/">LXDを試してみた · hnakamur's blog at github</a>の記事を書いて以来、LXD触る時間を作れてなかったのですが、久々に試してみました。</p>
<p>今では<a href="https://github.com/lxc/lxd">lxc/lxd</a>にVagrantfileが同梱されているので、それを使うだけで簡単に試せます。</p>
<p>VirtualBox 4.3.26, Vagrant 1.7.2, OS X Yosemiteという環境で試しました。</p>
<h2>操作手順</h2>
<h3>VagrantでVMを起動</h3>
<p>まずOS X上で以下のコマンドを実行します。</p>
<div class="highlight"><pre><span></span>git clone https://github.com/lxc/lxd
cd lxd
vagrant up
</pre></div>


<p><a href="https://github.com/lxc/lxd/blob/lxd-0.7/Vagrantfile">Vagrantfile</a>を見てみると、Vagrantのシェルプロビジョナでgoとlxdをインストールするようになっています。</p>
<p><a href="https://github.com/lxc/lxd/blob/lxd-0.7/scripts/vagrant/install-lxd.sh">lxd/install-lxd.sh at lxd-0.7 · lxc/lxd</a>を見てみると、<a href="https://github.com/lxc/lxd">lxdのREADME</a>と同様のセットアップ手順に加えてlxdをサービスとして登録して起動する処理まで含まれています。</p>
<h3>VMにログインしてlxcコマンドを試してみる</h3>
<p>以下のコマンドを実行してVMにログインします。</p>
<div class="highlight"><pre><span></span>vagrant ssh
</pre></div>


<p>以降のコマンドはVM上で実行します。</p>
<p><code>lxc</code> と <code>lxd</code> にはPATHが通った状態になっていることを確認しました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ which lxc
/home/vagrant/go/bin/lxc
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ which lxd
/home/vagrant/go/bin/lxd
</pre></div>


<p>バージョンを確認してみると、 <code>lxc</code>, <code>lxd</code> ともに0.7でした。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxd --version
0.7
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc --version
0.7
</pre></div>


<p><a href="https://github.com/lxc/lxd#first-steps">lxdのREADMEのFirst steps</a>に添って、ubuntuとdebianのイメージを取得します。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">ubuntu</span> <span class="nn">trusty</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">ubuntu</span> <span class="o">--</span><span class="n">alias</span> <span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpsccxc1fa</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150420</span><span class="n">_03</span><span class="p">:</span><span class="mi">49</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpsccxc1fa</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150420</span><span class="n">_03</span><span class="p">:</span><span class="mf">49.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Image</span> <span class="n">imported</span> <span class="k">as</span><span class="p">:</span> <span class="n">c9176e837c0012d6d0eed221312ee9fc761765319701f57e65e63542ad9beade</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">ubuntu</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span>
</pre></div>


<p>debianのほうは最初コピペミスでaliasに2回同じ値を指定してしまってエラーになりましたが、再度実行すると成功しました。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">debian</span> <span class="nn">wheezy</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_d1gz0q6</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mi">42</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_d1gz0q6</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">wheezy</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mf">42.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Image</span> <span class="n">imported</span> <span class="k">as</span><span class="p">:</span> <span class="n">cd398814f6e4e1e50799ba8249b80aa3558e5b05edf71a996a174def87569ae5</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">410</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">367</span><span class="p">,</span> <span class="ow">in</span> <span class="n">import_lxc</span>
    <span class="n">setup_alias</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">fingerprint</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">330</span><span class="p">,</span> <span class="ow">in</span> <span class="n">setup_alias</span>
    <span class="n">lxd</span><span class="o">.</span><span class="n">aliases_create</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">fingerprint</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">83</span><span class="p">,</span> <span class="ow">in</span> <span class="n">aliases_create</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to create alias: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
<span class="ne">Exception</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">create</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">debian</span> <span class="nn">wheezy</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpeqkwuvfw</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mi">42</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpeqkwuvfw</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">wheezy</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mf">42.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">This</span> <span class="n">image</span> <span class="ow">is</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">store</span><span class="o">.</span>
</pre></div>


<p>コンテナを起動します。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc launch ubuntuCreating container...done
Starting container...done
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc launch debian debian01
Creating container...done
Starting container...done
</pre></div>


<p>コンテナの一覧を表示してみます。ubuntuのほうはコンテナ名を指定しなかったので、自動で付けられています。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc list
+---------------------+---------+------------+------+-----------+
|        NAME         |  STATE  |    IPV4    | IPV6 | EPHEMERAL |
+---------------------+---------+------------+------+-----------+
| preterhuman-araceli | RUNNING | 10.0.3.188 |      | NO        |
| debian01            | RUNNING |            |      | NO        |
+---------------------+---------+------------+------+-----------+
</pre></div>


<p>debianのほうはIPアドレスが空になっていて、あれ？と思ったのですが、実行するタイミングが早すぎたようで、数秒立ってから再度実行するとアドレスが表示されました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc list
+---------------------+---------+------------+------+-----------+
|        NAME         |  STATE  |    IPV4    | IPV6 | EPHEMERAL |
+---------------------+---------+------------+------+-----------+
| preterhuman-araceli | RUNNING | 10.0.3.188 |      | NO        |
| debian01            | RUNNING | 10.0.3.42  |      | NO        |
+---------------------+---------+------------+------+-----------+
</pre></div>


<p>以前未実装だった <code>lxc shell</code> の代わりに <code>lxc exec</code> でコマンド実行やシェルでの対話操作ができるようになっていました。</p>
<p><code>lxc exec コンテナ名 コマンド 引数</code> のように指定すると、コンテナ内でコマンドを実行できます。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
6: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether 00:16:3e:01:bd:a1 brd ff:ff:ff:ff:ff:ff
    inet 10.0.3.42/24 brd 10.0.3.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::216:3eff:fe01:bda1/64 scope link
       valid_lft forever preferred_lft forever
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec preterhuman-araceli ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
4: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 00:16:3e:5e:6c:79 brd ff:ff:ff:ff:ff:ff
    inet 10.0.3.188/24 brd 10.0.3.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::216:3eff:fe5e:6c79/64 scope link
       valid_lft forever preferred_lft forever
</pre></div>


<p><code>uname -a</code> のようなコマンドを <code>lxc exec コンテナ名 コマンド 引数</code> のように指定するとlxcのオプションと解釈するようで、以下のエラーになりました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec preterhuman-araceli uname -a
error: flag provided but not defined: -a
</pre></div>


<p>コンテナ名のあとに <code>--</code> を入れれば回避出来ました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec preterhuman-araceli -- uname -a
Linux preterhuman-araceli 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
</pre></div>


<p>ただ、原因は不明なのですが、何回か実行してみると、時々何も出力されないことがありました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec debian01 -- uname -a
Linux debian01 3.13.0-48-generic #80-Ubuntu SMP Thu Mar 12 11:16:15 UTC 2015 x86_64 GNU/Linux
</pre></div>


<p><code>lxc exec コンテナ名 /bin/bash</code> のようにコマンドにシェルを指定すると、コンテナ内でシェルが起動され対話操作が出来ました。ubuntuコンテナの実際の画面では <code>ls</code> の結果もカラー表示されていました。</p>
<div class="highlight"><pre><span></span>vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$ lxc exec preterhuman-araceli /bin/bash
root@preterhuman-araceli:~# ls
root@preterhuman-araceli:~# pwd
/root
root@preterhuman-araceli:~# cd /
root@preterhuman-araceli:/# ls -l
total 60
drwxr-xr-x   2 root   root    4096 Apr 20 03:55 bin
drwxr-xr-x   2 root   root    4096 Apr 10  2014 boot
drwxr-xr-x   5 root   root     420 Apr 22 13:51 dev
drwxr-xr-x  63 root   root    4096 Apr 22 13:51 etc
drwxr-xr-x   3 root   root    4096 Apr 20 03:55 home
drwxr-xr-x  12 root   root    4096 Apr 20 03:54 lib
drwxr-xr-x   2 root   root    4096 Apr 20 03:54 lib64
drwxr-xr-x   2 root   root    4096 Apr 20 03:53 media
drwxr-xr-x   2 root   root    4096 Apr 10  2014 mnt
drwxr-xr-x   2 root   root    4096 Apr 20 03:53 opt
dr-xr-xr-x 109 nobody nogroup    0 Apr 22 13:51 proc
drwx------   2 root   root    4096 Apr 20 03:53 root
drwxr-xr-x   9 root   root     380 Apr 22 13:51 run
drwxr-xr-x   2 root   root    4096 Apr 20 03:55 sbin
drwxr-xr-x   2 root   root    4096 Apr 20 03:53 srv
dr-xr-xr-x  13 nobody nogroup    0 Apr 22 13:51 sys
drwxrwxrwt   2 root   root    4096 Apr 20 03:55 tmp
drwxr-xr-x  10 root   root    4096 Apr 20 03:53 usr
drwxr-xr-x  11 root   root    4096 Apr 20 03:53 var
root@preterhuman-araceli:/# ls
bin   dev  home  lib64  mnt  proc  run   srv  tmp  var
boot  etc  lib   media  opt  root  sbin  sys  usr
root@preterhuman-araceli:/# pwd
/
root@preterhuman-araceli:/# exit
vagrant@vagrant-ubuntu-trusty-64:~/go/src/github.com/lxc/lxd$
</pre></div>


<h2>おわりに</h2>
<p>以前試した時に比べて、かなり進歩してますね。</p>
<p>ten_forwardさんのライブマイグレーションの記事とかも、今後試してみようと思います。</p>
<ul>
<li><a href="http://d.hatena.ne.jp/defiant/20150415/1429089615">lxd を使ったライブマイグレーション (1) - TenForwardの日記</a></li>
<li><a href="http://d.hatena.ne.jp/defiant/20150415/1429090896">lxd を使ったライブマイグレーション (2) - TenForwardの日記</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is a custom version based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53263855-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>