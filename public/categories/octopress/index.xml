<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Octopress on hnakamur&#39;s blog at github</title>
    <link>/blog/categories/octopress/</link>
    <description>Recent content in Octopress on hnakamur&#39;s blog at github</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-JP</language>
    <lastBuildDate>Tue, 10 Jun 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="/blog/categories/octopress/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>久々にoctopressをアップデート</title>
      <link>/blog/2014/06/10/upgrade-octopress/</link>
      <pubDate>Tue, 10 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>/blog/2014/06/10/upgrade-octopress/</guid>
      <description>

&lt;p&gt;octopressをアップデートした時にハマったのでメモ。
アップデート手順は&lt;a href=&#34;http://blog.n-z.jp/blog/2013-12-21-update-octopress.html&#34;&gt;octopressをアップデートしてisolateを使い始めた - @znz blog&lt;/a&gt;の「octopress のアップデート」の部分を参考にしました。ありがとうございます。&lt;/p&gt;

&lt;h2 id=&#34;octopressのアップデート&#34;&gt;Octopressのアップデート&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://octopress.org/docs/updating/&#34;&gt;Updating Octopress - Octopress&lt;/a&gt;の&amp;rdquo;How to Update&amp;rdquo;のコマンドを順に実行しました。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git pull octopress master     # Get the latest Octopress
bundle install                # Keep gems updated
rake update_source            # update the template&#39;s source
rake update_style             # update the template&#39;s style
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;git pullではconflictsが起きたので、適宜修正しました。基本的にはHEAD側を採用。&lt;/p&gt;

&lt;h2 id=&#34;sass-globbingをgemfileに追加&#34;&gt;sass-globbingをGemfileに追加。&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;bundle exec rake generate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;を実行した時に&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;LoadError on line [&amp;quot;161&amp;quot;] of /Users/hnakamur/octopress/vendor/bundle/ruby/2.1.0/gems/compass-0.12.6/lib/compass/configuration/data.rb: cannot load such file -- sass-globbing
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;というエラーが出ました。&lt;/p&gt;

&lt;p&gt;Gemfileにsass-globbingを追加して、&lt;code&gt;bundle&lt;/code&gt;でインストールするとエラーは解消しました。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>octopressでgithubにブログ開設</title>
      <link>/blog/2012/03/03/how-to-setup-octopress/</link>
      <pubDate>Sat, 03 Mar 2012 00:00:00 +0000</pubDate>
      
      <guid>/blog/2012/03/03/how-to-setup-octopress/</guid>
      <description>

&lt;p&gt;rbenvとoctopressをインストールしてgithubにブログを作る手順のメモです。&lt;/p&gt;

&lt;h2 id=&#34;rbenvをインストール&#34;&gt;rbenvをインストール&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/sstephenson/rbenv#section_2.1&#34;&gt;sstephenson/rbenv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/sstephenson/ruby-build&#34;&gt;sstephenson/ruby-build&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;を参考にインストールしました。&lt;/p&gt;

&lt;p&gt;インストール先は~/.rbenvとしました。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd
git clone git://github.com/sstephenson/rbenv.git .rbenv

echo &#39;export PATH=&amp;quot;$HOME/.rbenv/bin:$PATH&amp;quot;&#39; &amp;gt;&amp;gt; .bash_profile
echo &#39;eval &amp;quot;$(rbenv init -)&amp;quot;&#39; &amp;gt;&amp;gt; .bash_profile

. ~/.bash_profile
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ruby-buildをインストールします。なお、私はHomebrewを使っているので/usr/localには書き込み権限をつけてあります。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd
git clone git://github.com/sstephenson/ruby-build.git
cd ruby-build
./install.sh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rbenvでruby 1.9.2-p290をインストール。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rbenv install 1.9.2-p290
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ rbenv versions
* 1.9.2-p290 (set by /Users/hnakamur/octopress/.rbenv-version)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;でインストールされたrubyがrbenvで認識されたことを確認。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rbenv global 1.9.2-p290
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で切替。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ which ruby
/Users/hnakamur/.rbenv/shims/ruby
$ ruby --version
ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-darwin11.3.0]
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;octopressでgitにブログをセットアップ&#34;&gt;octopressでgitにブログをセットアップ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://octopress.org/docs/deploying/github/&#34;&gt;Deploying to Github Pages - Octopress&lt;/a&gt;
を参考にセットアップしました。&lt;/p&gt;

&lt;p&gt;ここでは~/octopressを作業ディレクトリとしました。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd
git clone git://github.com/imathis/octopress.git octopre
cd octopress
ruby --version
gem install bundler
rbenv rehash
rake install
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ブラウザでgithubを開き、自分のアカウント(私の場合はhnakamur)でblogというプロジェクトを作ります。ブラウザで &lt;a href=&#34;https://github.com/hnakamur/blog&#34;&gt;https://github.com/hnakamur/blog&lt;/a&gt; を開き、&amp;rdquo;Next steps:&amp;ldquo;に&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git remote add origin git@github.com:hnakamur/blog.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;と書かれている行のgitのURL(ここではgit@github.com:hnakamur/blog.git)をコピーします。&lt;/p&gt;

&lt;p&gt;その後&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rake setup_github_pages
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;を実行し、&amp;rdquo;Enter the read/write url for your repository:&amp;ldquo;というプロンプトが出たらURLを貼り付けます。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Enter the read/write url for your repository: git@github.com:hnakamur/blog.git
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;vi _config.yml
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ブログタイトルなどを編集します。
``` text _config.yml
url: &lt;a href=&#34;http://hnakamur.github.com/blog&#34;&gt;http://hnakamur.github.com/blog&lt;/a&gt;
title: &amp;ldquo;hnakamur&amp;rsquo;s blog at github&amp;rdquo;
subtitle: my trial and error log
author: Hiroaki Nakamura
…(略)…
date_format: &amp;ldquo;%Y-%m-%d&amp;rdquo;
…(略)…&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
さらに
``` text _config.yml (before edit)
permalink: /blog/:year/:month/:day/:title/
…(略)…
category_dir: blog/categories
…(略)…
titlecase: true       # Converts page and post titles to titlecase
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;を以下のように変更します。
``` text _config.yml (before edit)
permalink: /:year/:month/:day/:title/
…(略)…
category_dir: categories
…(略)…
titlecase: false      # Converts page and post titles to titlecase&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;これは記事のパーマリンクやカテゴリページのURLが/blog/blog/…のようになってしまうのを/blog/…のようにするためです。

またタイトルの先頭を大文字にするのもオフにしています。

なお、アーカイブのページのURLは/blog/blog/archiveになってしまっていますが、変更方法をまだ見つけられていません。

## 記事の作成と投稿

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rake new_post[&amp;lsquo;Hello, octopress!&amp;rsquo;]&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;と実行すると、最後に
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Creating new post: source/_posts/2012-03-03-hello.markdown&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;と作成されたファイルが表示されます。

エディタでこのファイルを開いて記事を書きます。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;vi source/_posts/2012-03-03-hello.markdown&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;layout: post
title: &amp;ldquo;Hello, octopress!&amp;rdquo;
date: 2012-03-03
comments: true&lt;/p&gt;

&lt;h2 id=&#34;categories-octopress&#34;&gt;categories: octopress&lt;/h2&gt;

&lt;p&gt;octopressでブログ記事を投稿してみるテスト。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rake generate&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;でHTMLが生成されます。

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rake preview&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;を実行して、ブラウザで
http://localhost:4000/blog/
を開くと、プレビューできます。

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;rake deploy&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;でgithubにプッシュされ、10分ぐらい待つと
http://hnakamur.github.com/blog/
に記事のページで作られました。

時間がかかるのは初回にgithub pagesを作るときだけで、次回以降は即座に作られました。

## 記事のソースをgithubにプッシュ

リモートの設定にoriginを追加して、そこをデフォルトのブランチに設定。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;git remote add origin git@github.com:hnakamur/blog.git
git config branch.master.remote origin&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
設定の変更と生成されたソースをコミット、プッシュします。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;git add .
git commit -m &amp;lsquo;Modify config. Add source and sass&amp;rsquo;
git push origin HEAD:source&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
github上でのブランチ名をsourceではなくmasterにしてよければ、単に
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;git push&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;でOKです。

## ローカルのApacheでプレビュー

Apacheは事前にセットアップ済みという前提で、プレビュー用の設定を追加します。

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sudo vi /etc/apache2/other/blog.conf&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;と実行して、以下の内容で作成します(hnakamurの部分は自分のアカウント名で置換してください)。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Alias /blog /Users/hnakamur/octopress/public/blog
&lt;Directory /Users/hnakamur/octopress/public/blog&gt;
    AllowOverride None
  DirectoryIndex index.html
    Order allow,deny
    Allow from all
&lt;/Directory&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sudo apachectl restart&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;でApacheを再起動します。

これ以降は記事を編集してrake generateだけ実行すれば [http://localhost/blog/](http://localhost/blog/) を開いてプレビューできます。

## 今回のはまりポイント

### YAMLで文字列を&amp;quot;&amp;quot;で囲む必要があった

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;$ rake generate
(in /Users/hnakamur/octopress)&lt;/p&gt;

&lt;h2 id=&#34;generating-site-with-jekyll&#34;&gt;Generating Site with Jekyll&lt;/h2&gt;

&lt;p&gt;unchanged sass/screen.scss
/Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/psych.rb:148:in &lt;code&gt;parse&#39;: couldn&#39;t parse YAML at line 16 column 13 (Psych::SyntaxError)
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/psych.rb:148:in&lt;/code&gt;parse_stream&amp;rsquo;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/psych.rb:119:in &lt;code&gt;parse&#39;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/psych.rb:106:in&lt;/code&gt;load&amp;rsquo;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/psych.rb:205:in &lt;code&gt;load_file&#39;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/gems/1.9.1/gems/jekyll-0.11.0/lib/jekyll.rb:119:in&lt;/code&gt;configuration&amp;rsquo;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/gems/1.9.1/gems/jekyll-0.11.0/bin/jekyll:207:in &lt;code&gt;&amp;lt;top (required)&amp;gt;&#39;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/gems/1.9.1/bin/jekyll:19:in&lt;/code&gt;load&amp;rsquo;
    from /Users/hnakamur/.rbenv/versions/1.9.2-p290/lib/ruby/gems/1.9.1/bin/jekyll:19:in `&lt;main&gt;&amp;lsquo;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;_config.ymlの
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;date_format: %Y-%m-%dT%k:%M:%S%z&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;を
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;date_format: &amp;ldquo;%Y-%m-%dT%k:%M:%S%z&amp;rdquo;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;と修正して再実行したらOKでした。


### git push origin sourceでエラー

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;$ git push origin source
error: src refspec source does not match any.
error: failed to push some refs to &amp;lsquo;git@github.com:hnakamur/blog.git&amp;rsquo;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
ググって [Error when &amp;quot;git push&amp;quot; to github - Stack Overflow](http://stackoverflow.com/questions/959477/error-when-git-push-to-github) を発見。

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;git push origin HEAD:source
```
にしたらOK。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>