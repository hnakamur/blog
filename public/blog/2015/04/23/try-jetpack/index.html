<!DOCTYPE html>
<html lang="ja">
<head>
        <meta charset="utf-8" />
        <title>jetpackを試してみた</title>
        <link rel="stylesheet" href="../../../../../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../../../../../">hnakamur's blog at github </a></h1>
                <nav><ul>
                    <li class="active"><a href="../../../../../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="../../../../../blog/2015/04/23/try-jetpack/" rel="bookmark"
           title="Permalink to jetpackを試してみた">jetpackを試してみた</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-04-23T01:27:00+09:00">
                Published: 2015-04-23
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://hnakamur.github.io">Hiroaki Nakamura</a>
        </address>
<p>In <a href="../../../../../category/blog.html">blog</a>.</p>
<p>tags: <a href="../../../../../tag/jetpack.html">jetpack</a> </p>
</footer><!-- /.post-info -->      <h2>はじめに</h2>
<p><a href="https://github.com/3ofcoins/jetpack#using-jetpack">3ofcoins/jetpack</a>はFreeBSD, Jail, ZFSを使った<a href="https://github.com/appc/spec">App Container Spec</a>の実装です。まだプロトタイプレベルとのことです。Go言語で実装されています。</p>
<p>masterの最新を試しました。今後のためにコミットハッシュをメモしておきます。</p>
<div class="highlight"><pre><span></span><span class="nl">sunshine5</span><span class="p">:</span><span class="n">jetpack</span> <span class="n">hnakamur</span><span class="err">$</span> <span class="n">g</span> <span class="n">log</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">commit</span> <span class="mo">07</span><span class="mi">92</span><span class="n">b938c7f9bdd43f9d117bfdec6cd91e223ee5</span>
<span class="nl">Author</span><span class="p">:</span> <span class="n">Maciej</span> <span class="n">Pasternacki</span> <span class="o">&lt;</span><span class="n">maciej</span><span class="mi">@3</span><span class="n">ofcoins</span><span class="p">.</span><span class="n">net</span><span class="o">&gt;</span>
<span class="nl">Date</span><span class="p">:</span>   <span class="n">Mon</span> <span class="n">Apr</span> <span class="mi">13</span> <span class="mo">06</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">57</span> <span class="mi">2015</span>

    <span class="n">Make</span> <span class="n">image</span> <span class="n">building</span> <span class="n">work</span> <span class="n">with</span> <span class="n">per</span><span class="o">-</span><span class="n">app</span> <span class="n">rootfs</span>
</pre></div>


<h2>セットアップ</h2>
<p>Vagrantfileが用意されているのでそれを使いました。
VirtualBox 4.3.26, Vagrant 1.7.2, OS X Yosemiteという環境で試しました。</p>
<p>VagrantのAnsibleプロビジョナを利用しているので、予めホスト側にAnsibleをセットアップしておいてください。</p>
<div class="highlight"><pre><span></span>vagrant up
vagrant ssh
</pre></div>


<h2>Jetpackを使ってみる</h2>
<p><a href="https://github.com/3ofcoins/jetpack#using-jetpack">Using Jetpack</a>の説明にそって、試してみました。</p>
<p>引数無しで単に <code>jetpack</code> と実行すると説明が出ます。</p>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">jetpack</span>
<span class="n">Usage</span><span class="p">:</span> <span class="n">jetpack</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="n">COMMAND</span><span class="o">...</span>
<span class="n">Options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">config</span><span class="o">=</span><span class="n">PATH</span>  <span class="n">Configuration</span> <span class="nb">file</span> <span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">jetpack</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
  <span class="o">-</span><span class="n">help</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span>     <span class="n">Display</span> <span class="n">this</span> <span class="n">help</span> <span class="n">screen</span>
<span class="n">Commands</span><span class="p">:</span>
  <span class="n">help</span>                                    <span class="n">Display</span> <span class="n">this</span> <span class="n">help</span> <span class="n">screen</span>
  <span class="n">init</span>                                    <span class="n">Initialize</span> <span class="n">host</span>
  <span class="n">info</span>                                    <span class="n">Show</span> <span class="k">global</span> <span class="n">information</span>
  <span class="n">test</span>                                    <span class="n">Run</span> <span class="n">integration</span> <span class="n">tests</span>
  <span class="n">image</span> <span class="nb">list</span> <span class="p">[</span><span class="n">QUERY</span><span class="p">]</span>                      <span class="n">List</span> <span class="n">images</span>
  <span class="n">image</span> <span class="kn">import</span> <span class="nn">ARCHIVE</span> <span class="p">[</span><span class="n">MANIFEST</span><span class="p">]</span>         <span class="n">Import</span> <span class="n">image</span> <span class="kn">from</span> <span class="nn">an</span> <span class="nn">archive</span>
  <span class="n">image</span> <span class="n">IMAGE</span> <span class="n">build</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span> <span class="n">COMMAND</span><span class="o">...</span>  <span class="n">Build</span> <span class="n">new</span> <span class="n">image</span> <span class="kn">from</span> <span class="nn">an</span> <span class="nn">existing</span> <span class="nn">one</span>
                    <span class="o">-</span><span class="nb">dir</span><span class="o">=.</span>                <span class="n">Location</span> <span class="n">on</span> <span class="n">build</span> <span class="n">directory</span> <span class="n">on</span> <span class="n">host</span>
                    <span class="o">-</span><span class="n">cp</span><span class="o">=</span><span class="n">PATH</span><span class="o">...</span>           <span class="n">Copy</span> <span class="n">additional</span> <span class="n">files</span> <span class="kn">from</span> <span class="nn">host</span>
  <span class="n">image</span> <span class="n">IMAGE</span> <span class="n">show</span>                        <span class="n">Display</span> <span class="n">image</span> <span class="n">details</span>
  <span class="n">image</span> <span class="n">IMAGE</span> <span class="n">export</span> <span class="p">[</span><span class="n">PATH</span><span class="p">]</span>               <span class="n">Export</span> <span class="n">image</span> <span class="n">to</span> <span class="n">an</span> <span class="n">AMI</span> <span class="nb">file</span>
                                          <span class="n">Output</span> <span class="n">to</span> <span class="n">stdout</span> <span class="k">if</span> <span class="n">no</span> <span class="n">PATH</span> <span class="n">given</span>
  <span class="n">image</span> <span class="n">IMAGE</span> <span class="n">destroy</span>                     <span class="n">Destroy</span> <span class="n">image</span>
  <span class="n">pod</span> <span class="nb">list</span>                                <span class="n">List</span> <span class="n">pods</span>
  <span class="n">pod</span> <span class="n">create</span> <span class="p">[</span><span class="n">FLAGS</span><span class="p">]</span> <span class="n">IMAGE</span> <span class="p">[</span><span class="n">IMAGE</span> <span class="n">FLAGS</span><span class="p">]</span> <span class="p">[</span><span class="n">IMAGE</span> <span class="p">[</span><span class="n">IMAGE</span> <span class="n">FLAGS</span><span class="p">]</span> <span class="o">...</span><span class="p">]</span>
                                          <span class="n">Create</span> <span class="n">new</span> <span class="n">pod</span> <span class="kn">from</span> <span class="nn">image</span>
             <span class="o">-</span><span class="n">help</span>                        <span class="n">Show</span> <span class="n">detailed</span> <span class="n">help</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">show</span>                            <span class="n">Display</span> <span class="n">pod</span> <span class="n">details</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">run</span>                             <span class="n">Run</span> <span class="n">pod</span><span class="s1">&#39;s application</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">console</span> <span class="p">[</span><span class="n">USER</span><span class="p">]</span>                  <span class="n">Open</span> <span class="n">console</span> <span class="n">inside</span> <span class="n">the</span> <span class="n">pod</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">ps</span><span class="o">|</span><span class="n">top</span><span class="o">|</span><span class="n">killall</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="o">...</span><span class="p">]</span>
                                          <span class="n">Manage</span> <span class="n">pod</span><span class="s1">&#39;s processes</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">kill</span>                <span class="n">Kill</span> <span class="n">running</span> <span class="n">pod</span>
  <span class="n">pod</span> <span class="n">POD</span> <span class="n">destroy</span>             <span class="n">Destroy</span> <span class="n">pod</span>
<span class="n">Needs</span> <span class="n">Explanation</span><span class="p">:</span>
  <span class="n">ARCHIVE</span><span class="p">,</span> <span class="n">MANIFEST</span>  <span class="n">May</span> <span class="n">be</span> <span class="n">filesystem</span> <span class="n">paths</span> <span class="ow">or</span> <span class="n">URLs</span><span class="o">.</span>
            <span class="n">cp</span><span class="o">=</span><span class="n">PATH</span>  <span class="n">This</span> <span class="n">option</span> <span class="n">can</span> <span class="n">be</span> <span class="n">given</span> <span class="n">multiple</span> <span class="n">times</span>
              <span class="n">QUERY</span>  <span class="n">Is</span> <span class="n">an</span> <span class="n">expression</span> <span class="n">that</span> <span class="n">looks</span> <span class="n">like</span> <span class="n">this</span><span class="p">:</span>
                      <span class="o">-</span> <span class="n">NAME</span><span class="p">[,</span><span class="n">LABEL</span><span class="o">=</span><span class="n">VALUE</span><span class="p">[,</span><span class="n">LABEL</span><span class="o">=</span><span class="n">VALUE</span><span class="p">[,</span><span class="o">...</span><span class="p">]]]</span>
                      <span class="o">-</span> <span class="n">NAME</span><span class="p">:</span><span class="n">VERSION</span> <span class="p">(</span><span class="n">alias</span> <span class="k">for</span> <span class="n">NAME</span><span class="p">:</span><span class="n">version</span><span class="o">=</span><span class="n">VERSION</span><span class="p">)</span>
              <span class="n">IMAGE</span>  <span class="n">Can</span> <span class="n">be</span><span class="p">:</span>
                      <span class="o">-</span> <span class="n">an</span> <span class="n">UUID</span> <span class="p">(</span><span class="n">XXXXXXXX</span><span class="o">-</span><span class="n">XXXX</span><span class="o">-</span><span class="n">XXXX</span><span class="o">-</span><span class="n">XXXX</span><span class="o">-</span><span class="n">XXXXXXXX</span><span class="p">),</span>
                      <span class="o">-</span> <span class="n">a</span> <span class="n">checksum</span> <span class="p">(</span><span class="n">sha512</span><span class="o">-...</span><span class="p">),</span> <span class="ow">or</span>
                      <span class="o">-</span> <span class="n">a</span> <span class="n">QUERY</span> <span class="p">(</span><span class="n">which</span> <span class="n">can</span><span class="s1">&#39;t be ambiguous).</span>
          <span class="n">POD</span>  <span class="n">Has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">an</span> <span class="n">UUID</span> <span class="k">for</span> <span class="n">now</span>
<span class="n">Helpful</span> <span class="n">Aliases</span><span class="p">:</span>
  <span class="n">i</span><span class="o">|</span><span class="n">img</span> <span class="o">...</span> <span class="o">--</span> <span class="n">image</span> <span class="o">...</span>
  <span class="n">p</span> <span class="o">...</span> <span class="o">--</span> <span class="n">pod</span> <span class="o">...</span>
  <span class="n">image</span><span class="p">,</span> <span class="n">images</span> <span class="o">--</span> <span class="n">image</span> <span class="nb">list</span>
  <span class="n">pod</span><span class="p">,</span> <span class="n">pods</span> <span class="o">--</span> <span class="n">pod</span> <span class="nb">list</span>
  <span class="n">image</span> <span class="n">build</span><span class="o">|</span><span class="n">show</span><span class="o">|</span><span class="n">export</span><span class="o">|</span><span class="n">destroy</span> <span class="n">IMAGE</span> <span class="o">...</span> <span class="o">--</span> <span class="n">image</span> <span class="n">IMAGE</span> <span class="n">build</span><span class="o">|</span><span class="n">show</span><span class="o">|...</span> <span class="o">...</span>
</pre></div>


<p><code>jetpack init</code> でZFSのデータセットとディレクトリ構造を初期化します。が、これはプロビジョニングで実行済みだったようです。</p>
<div class="highlight"><pre><span></span>$ jetpack init
/vagrant/jetpack/host.go:82: Host already initialized
</pre></div>


<p><code>jetpack info</code> で状態を確認してみました。</p>
<div class="highlight"><pre><span></span>$ jetpack info
JetPack <span class="m">0</span>.0.1 <span class="o">(</span>v0.0.1-81-g0792b93<span class="o">)</span>, compiled on <span class="m">2015</span>-04-22T15:38:43Z
ZFS Dataset zroot/jetpack
  Mountpoint  /var/jetpack
Configuration:
  root.zfs                zroot/jetpack
  root.zfs.mountpoint     /var/jetpack
  images.ami.store        no
  images.ami.compression  xz
  images.zfs.atime        off
  images.zfs.compress     lz4
  jail.interface          lo1
  jail.namePrefix         jetpack/
  debug                   off
</pre></div>


<p><code>jetpack test</code> でスモークテストを実行してみましたが、一般ユーザでは権限不足でした。</p>
<div class="highlight"><pre><span></span>$ jetpack <span class="nb">test</span>
ERROR: mkdir /var/jetpack/test.881699652: permission denied
run.Command<span class="o">[</span>/usr/local/libexec/jetpack/test.integration <span class="nv">dataset</span><span class="o">=</span>zroot/jetpack<span class="o">]</span>: <span class="nb">exit</span> status <span class="m">2</span>
</pre></div>


<p>スモークテストという言葉は知らなかったのですが、本格的なテストの前の簡易テストという意味だそうです。</p>
<ul>
<li><a href="http://nolan00267.blogspot.jp/2013/12/itsmoke-test.html">ビジネス英語とアメリカ生活 | カリフォルニアの陽射しの中で: IT英語:　ソフトウェアの試験なのにSmoke Testとは、これいかに?</a></li>
<li><a href="http://www.itmedia.co.jp/im/articles/1111/07/news166.html">情報システム用語事典：スモークテスト（すもーくてすと） - ITmedia エンタープライズ</a></li>
</ul>
<p>sudoつきで実行すると、さっきよりは進みましたが <code>resolv.conf</code> が無いというエラーになってしまいました。</p>
<div class="highlight"><pre><span></span>$ sudo jetpack <span class="nb">test</span>
...<span class="o">(</span>snip<span class="o">)</span>...
Pod dying since <span class="m">51</span>.336704525s, waiting...
Image 6d058709-d7f9-45c5-a40b-0f9a5c81a90b
  Hash       sha512-3d526a2a0e40605d1d5f50a6596f210ff26d7486867f12f4ffa395c3600028a01473c126c11b1030a4c299c82799b56a3493773d008743ae33f1230dc71384a1
  Origin     b73f4bf5-8988-4e0f-87f4-31723167e2ef
  Timestamp  <span class="m">2015</span>-04-22 <span class="m">16</span>:24:15.597136136 +0000 UTC
  Manifest freebsd-base
    Labels
      version  <span class="m">10</span>.1.9
      os       freebsd
      arch     amd64
    Annotations
      timestamp  <span class="m">2015</span>-04-22T16:24:15.595105431Z
jetpack image freebsd-base build -cp<span class="o">=</span>/usr/local/share/jetpack/jetpack.image.mk  /usr/bin/make .jetpack.build.
open /var/jetpack/test.467360619/pods/4c518b91-afa8-4e28-86ca-4c4d0fedc313/rootfs/0/etc/resolv.conf: no such file or directory
/vagrant/jetpack/pod.go:281:
/vagrant/jetpack/pod.go:500:
/vagrant/jetpack/pod.go:501:
/vagrant/jetpack/image.go:331:
*** Error code <span class="m">1</span>

Stop.
make: stopped in /usr/local/share/examples/jetpack/example.showenv
ERROR: run.Command<span class="o">[</span>make -C /usr/local/share/examples/jetpack/example.showenv<span class="o">]</span>: <span class="nb">exit</span> status <span class="m">1</span>
run.Command<span class="o">[</span>/usr/local/libexec/jetpack/test.integration <span class="nv">dataset</span><span class="o">=</span>zroot/jetpack<span class="o">]</span>: <span class="nb">exit</span> status <span class="m">2</span>
</pre></div>


<p>一旦置いておいて、先に進みます。</p>
<p>rootユーザで <code>/usr/local/share/examples/jetpack</code> 以下の <code>freebsd-base.release</code>, <code>freebsd-base</code>, <code>example.showenv</code> イメージを順に作成します。</p>
<p>まず <code>freebsd-base.release</code> イメージを作ります。</p>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">sudo</span> <span class="o">-</span><span class="n">i</span>
<span class="n">root</span><span class="nd">@packer</span><span class="o">-</span><span class="n">freebsd</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="o">~</span> <span class="c1"># cd /usr/local/share/examples/jetpack</span>
<span class="n">root</span><span class="nd">@packer</span><span class="o">-</span><span class="n">freebsd</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">jetpack</span> <span class="c1"># cd freebsd-base.release/</span>
<span class="n">root</span><span class="nd">@packer</span><span class="o">-</span><span class="n">freebsd</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">jetpack</span><span class="o">/</span><span class="n">freebsd</span><span class="o">-</span><span class="n">base</span><span class="o">.</span><span class="n">release</span> <span class="c1"># make</span>
<span class="n">sha256</span> <span class="o">-</span><span class="n">c</span> <span class="mi">2</span><span class="n">b028a894d25711ad496762622a52d74b1e32ee04693ad1cf056e3ddcdc23975</span> <span class="n">base</span><span class="o">.</span><span class="n">txz</span>
<span class="n">SHA256</span> <span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">txz</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="n">b028a894d25711ad496762622a52d74b1e32ee04693ad1cf056e3ddcdc23975</span>
<span class="n">jetpack</span> <span class="n">image</span> <span class="kn">import</span> <span class="nn">base.txz</span> <span class="nn">manifest.json</span>
<span class="o">-</span>                                             <span class="mi">100</span><span class="o">%</span> <span class="n">of</span>   <span class="mi">63</span> <span class="n">MB</span> <span class="mi">6067</span> <span class="n">kBps</span> <span class="mo">00</span><span class="n">m11s</span>
<span class="o">-</span>                                             <span class="mi">100</span><span class="o">%</span> <span class="n">of</span>  <span class="mi">184</span>  <span class="n">B</span>  <span class="mi">519</span> <span class="n">kBps</span> <span class="mo">00</span><span class="n">m00s</span>
<span class="n">Image</span> <span class="mi">445</span><span class="n">da390</span><span class="o">-</span><span class="mf">2e49</span><span class="o">-</span><span class="mi">4</span><span class="n">b7f</span><span class="o">-</span><span class="mi">921</span><span class="n">d</span><span class="o">-</span><span class="mi">47</span><span class="n">ce6114cb02</span>
  <span class="n">Hash</span>       <span class="n">sha512</span><span class="o">-</span><span class="mf">3e5767</span><span class="n">bda2018294312cce0d0ef2003cf886af246cbbfe5050a266a94bdcfe9df94c9e73ef4452b487cf8bdc8279806e70aef75ea8f644d24223cf227bc75df8</span>
  <span class="n">Origin</span>     <span class="n">base</span><span class="o">.</span><span class="n">txz</span>
  <span class="n">Timestamp</span>  <span class="mi">2015</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">16</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mf">07.861508005</span> <span class="o">+</span><span class="mo">0000</span> <span class="n">UTC</span>
  <span class="n">Manifest</span> <span class="n">freebsd</span><span class="o">-</span><span class="n">base</span><span class="o">/</span><span class="n">release</span>
    <span class="n">Labels</span>
      <span class="n">version</span>  <span class="mf">10.1</span>
      <span class="n">os</span>       <span class="n">freebsd</span>
      <span class="n">arch</span>     <span class="n">amd64</span>
    <span class="n">Annotations</span>
      <span class="n">timestamp</span>  <span class="mi">2015</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">22</span><span class="n">T16</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mf">18.685140617</span><span class="n">Z</span>
</pre></div>


<p>次に <code>freebsd-base</code> イメージを作ります。</p>
<div class="highlight"><pre><span></span>root@packer-freebsd-10:/usr/local/share/examples/jetpack/freebsd-base.release # cd ../freebsd-base
root@packer-freebsd-10:/usr/local/share/examples/jetpack/freebsd-base # make
jetpack image freebsd-base/release build -cp=/usr/local/share/jetpack/jetpack.image.mk  /usr/bin/make .jetpack.build.
sed -i &#39;&#39; &#39;s|^Components.*|Components world/base|&#39; /etc/freebsd-update.conf
install -v -m 0644 rc.conf /etc/rc.conf
install: rc.conf -&gt; /etc/rc.conf
install -v -m 0600 entropy /entropy
install: entropy -&gt; /entropy
patch /usr/sbin/freebsd-update &lt; freebsd-update.patch
Hmm...  Looks like a unified diff to me...
The text leading up to this was:
--------------------------
|--- /usr/sbin/freebsd-update   2015-02-08 22:15:58.178818000 +0100
|+++ freebsd-update 2015-02-09 13:45:42.202917000 +0100
--------------------------
Patching file /usr/sbin/freebsd-update using Plan A...
Hunk #1 succeeded at 610 (offset -8 lines).
done
env PAGER=cat freebsd-update -s update6.freebsd.org fetch install
Looking up update6.freebsd.org mirrors... none found.
Fetching public key from update6.freebsd.org... done.
Fetching metadata signature for 10.1-RELEASE from update6.freebsd.org... done.
Fetching metadata index... done.
Fetching 2 metadata files... done.
Inspecting system... done.
Preparing to download files... done.
Fetching 706 patches.....10....20....30....40....50....60....70....80....90....100....110....120....130....140....150....160....170....180....190....200....210....220....230....240....250....260....270....280....290....300....310....320....330....340....350....360....370....380....390....400....410....420....430....440....450....460....470....480....490....500....510....520....530....540....550....560....570....580....590....600....610....620....630....640....650....660....670....680....690....700... done.
Applying patches... done.
Fetching 1 files... done.

The following files will be updated as part of updating to 10.1-RELEASE-p9:
/bin/freebsd-version
/boot/boot1.efi
/boot/boot1.efifat
...(略)...
/var/db/mergemaster.mtree
Installing updates... done.
rm -rf /var/db/freebsd-update/*
./manifest.json.sh &gt; manifest.json
Pod dying since 64.761583ms, waiting...
...(略)...
Pod dying since 51.461102458s, waiting...
Image 9323ac42-0f39-4f42-90de-ac4de60420dd
  Hash       sha512-3fb309e4d9a998bd910ce07dbfcef447508ea2146fabd88056975abc224d49094b3ff22c61c6c3aae170ee5e69bff72c43fb6e1153ae4f68607246cb50cc4d3d
  Origin     445da390-2e49-4b7f-921d-47ce6114cb02
  Timestamp  2015-04-22 16:38:35.737407036 +0000 UTC
  Manifest freebsd-base
    Labels
      version  10.1.9
      os       freebsd
      arch     amd64
    Annotations
</pre></div>


<p>次に <code>freebsd-base</code> イメージを作ります。</p>
<div class="highlight"><pre><span></span>root@packer-freebsd-10:/usr/local/share/examples/jetpack/freebsd-base # cd ../example.showenv/
root@packer-freebsd-10:/usr/local/share/examples/jetpack/example.showenv # make
jetpack image freebsd-base build -cp=/usr/local/share/jetpack/jetpack.image.mk  /usr/bin/make .jetpack.build.
open /var/jetpack/pods/eaa0ec11-a7ad-4170-ac30-472444b9f849/rootfs/0/etc/resolv.conf: no such file or directory
/vagrant/jetpack/pod.go:281:
/vagrant/jetpack/pod.go:500:
/vagrant/jetpack/pod.go:501:
/vagrant/jetpack/image.go:331:
*** Error code 1

Stop.
make: stopped in /usr/local/share/examples/jetpack/example.showenv
</pre></div>


<p>スモークテストの時と同じエラーが出ました。
とりあえず今回はここまでとします。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is a custom version based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53263855-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>