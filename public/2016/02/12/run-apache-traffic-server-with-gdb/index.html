<!DOCTYPE html>
<html lang="ja">
<head>
        <meta charset="utf-8" />
        <title>Apache Traffic Server を GDB で動かす</title>
        <link rel="stylesheet" href="../../../../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../../../../">hnakamur's blog at github </a></h1>
                <nav><ul>
                    <li class="active"><a href="../../../../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="../../../../2016/02/12/run-apache-traffic-server-with-gdb/" rel="bookmark"
           title="Permalink to Apache Traffic Server を GDB で動かす">Apache Traffic Server を GDB で動かす</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-12T00:02:00+09:00">
                Published: 2016-02-12
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://hnakamur.github.io">Hiroaki Nakamura</a>
        </address>
<p>In <a href="../../../../category/blog.html">blog</a>.</p>
<p>tags: <a href="../../../../tag/apache-traffic-server.html">apache-traffic-server</a> <a href="../../../../tag/gdb.html">gdb</a> </p>
</footer><!-- /.post-info -->      <h2>はじめに</h2>
<p><a href="http://gihyo.jp/magazine/wdpress/archive/2012/vol69">WEB+DB PRESS Vol.69｜技術評論社</a> にあった <a href="http://dev.ariel-networks.com/wp/archives/author/inoue">アリエル・ネットワーク㈱の井上さん</a>による「大規模コードリーディング」の特集を読んで、静的解析 (コードを読んで理解する手法) と動的解析 (実行時の動作を予測しながら構造を理解する方法) を行ったり来たり繰り返すのが良いと理解しました。</p>
<p>というわけで、 <a href="/blog/2016/02/11/apache-traffic-server-code-reading/">Apache Traffic Server のコードリーディング · hnakamur's blog at github</a> でコードを読みつつ、デバッガ上で動かしてみました。手順は整理してないですが、とりあえず自分向けメモです。</p>
<h2>試した環境</h2>
<p>試した環境は <a href="https://github.com/hnakamur/trafficserver-ansible-playbook">hnakamur/trafficserver-ansible-playbook</a> で構築したものです。Apache Traffic Server のバージョンは 6.1.1 です。</p>
<h2>事前準備</h2>
<h3>debuginfo パッケージのインストール</h3>
<p>gdb でプログラムを実行するにはプログラムのパッケージと依存パッケージの debuginfo が必要です。これは、たぶん以下のコマンドでインストールできます。</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">yum</span><span class="o">-</span><span class="n">utils</span>
<span class="n">sudo</span> <span class="n">debuginfo</span><span class="o">-</span><span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">trafficserver</span>
</pre></div>


<h3>debuginfo パッケージのインストールの試行錯誤メモ</h3>
<p>この項は上のコマンドを知る前に試した手順のメモです。</p>
<p>まずデバッグ情報のパッケージが必要だと思ったので、以下のコマンドでインストールしました。</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">trafficserver</span><span class="o">-</span><span class="n">debuginfo</span>
</pre></div>


<p>次に</p>
<div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="k">start</span> <span class="n">trafficserver</span>
</pre></div>


<p>を実行して trafficserver のサービスを起動した状態で</p>
<div class="highlight"><pre><span></span><span class="n">ps</span> <span class="n">auxww</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">traffic</span>
</pre></div>


<p>を実行して <code>traffic_server</code> のコマンドラインをメモします。</p>
<div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">traffic_server</span> <span class="o">-</span><span class="n">M</span> <span class="c1">--bind_stdout /var/log/trafficserver/traffic.out --bind_stderr /var/log/trafficserver/traffic.out --httpport 80:fd=9</span>
</pre></div>


<p>となっていました。 <a href="https://docs.trafficserver.apache.org/en/latest/appendices/command-line/traffic_server.en.html">traffic_server — Apache Traffic Server 6.2.0 documentation</a> を見ると <code>-M</code> は <code>--remote_management</code> のショートオプションです。 <code>systemctl start trafficserver</code> でサービスを起動すると <code>traffic_cop</code> と <code>traffic_manager</code> 経由で <code>traffic_server</code> が起動するのですが、その場合に必要になるオプションのようです。 gdb で実行するときは <code>-M</code> は外します。</p>
<div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">stop</span> <span class="n">trafficserver</span>
</pre></div>


<p>でサービスを停止します。</p>
<div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">traffic_server</span>
</pre></div>


<p>で gdb を起動します。</p>
<div class="highlight"><pre><span></span><span class="k">break</span> <span class="nv">HttpSM</span>::<span class="nv">set_next_state</span>
</pre></div>


<p>などとブレークポイントを設定します。ブレークポイントは Apache Traffic Server のソースコードを読んで、自分が止めたい場所にお好みで設定します。</p>
<p>gdb のプロンプトで以下のように入力して、 Apache Traffic Server を実行します。</p>
<div class="highlight"><pre><span></span><span class="n">run</span> <span class="c1">--bind_stdout /var/log/trafficserver/traffic.out --bind_stderr /var/log/trafficserver/traffic.out --httpport 80:fd=9</span>
</pre></div>


<p>ところがdebuginfoが足りず、以下のようなエラーになってしまいました。</p>
<div class="highlight"><pre><span></span><span class="k">[Inferior 1 (process 17590) exited with code 01]</span>
<span class="na">Missing separate debuginfos, use: debuginfo-install glibc-2.17-106.el7_2.1.x86_64 hwloc-libs-1.7-5.el7.x86_64 keyutils-libs-1.5.8-3.el7.x86_64 krb5-libs-1.13.2-10.el7.x86_64 libcom_err-1.42.9-7.el7.x86_64 libgcc-4.8.5-4.el7.x86_64 libpciaccess-0.13.4-2.el7.x86_64 libselinux-2.2.2-6.el7.x86_64 libstdc++-4.8.5-4.el7.x86_64 libxml2-2.9.1-6.el7_2.2.x86_64 nss-softokn-freebl-3.16.2.3-13.el7_1.x86_64 numactl-libs-2.0.9-5.el7_1.x86_64 openssl-libs-1.0.1e-51.el7_2.2.x86_64 pcre-8.32-15.el7.x86_64 tcl-8.5.13-8.el7.x86_64 xz-libs-5.1.2-12alpha.el7.x86_64 zlib-1.2.7-15.el7.x86_64</span>
</pre></div>


<p><code>use:</code> の後をコピペして実行して途中で (y/n) で聞かれたら y を押すと、必要な debuginfo をイントール出来ました。</p>
<p>調べてみると、最初から以下のコマンドを実行しておけば依存するライブラリの debuginfo もインストールできるようです。</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">debuginfo</span><span class="o">-</span><span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">trafficserver</span>
</pre></div>


<p>なお、 <code>debuginfo-install</code> コマンドは <code>yum-utils</code> パッケージに入っているので予めインストールしておきます。</p>
<h2>実行例</h2>
<p>まず、</p>
<div class="highlight"><pre><span></span><span class="n">gdb</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">traffic_server</span>
</pre></div>


<p>で gdb を起動し <code>HttpSM::set_next_state</code> にブレークポイントを設定して traffic_server を実行しました。</p>
<div class="highlight"><pre><span></span>[<span class="nv">root</span>@<span class="nv">localhost</span> <span class="o">~</span>]# <span class="nv">gdb</span> <span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">traffic_server</span>
<span class="nv">GNU</span> <span class="nv">gdb</span> <span class="ss">(</span><span class="nv">GDB</span><span class="ss">)</span> <span class="nv">Red</span> <span class="nv">Hat</span> <span class="nv">Enterprise</span> <span class="nv">Linux</span> <span class="mi">7</span>.<span class="mi">6</span>.<span class="mi">1</span><span class="o">-</span><span class="mi">80</span>.<span class="nv">el7</span>
<span class="nv">Copyright</span> <span class="ss">(</span><span class="nv">C</span><span class="ss">)</span> <span class="mi">2013</span> <span class="nv">Free</span> <span class="nv">Software</span> <span class="nv">Foundation</span>, <span class="nv">Inc</span>.
<span class="nv">License</span> <span class="nv">GPLv3</span><span class="o">+</span>: <span class="nv">GNU</span> <span class="nv">GPL</span> <span class="nv">version</span> <span class="mi">3</span> <span class="nv">or</span> <span class="nv">later</span> <span class="o">&lt;</span><span class="nv">http</span>:<span class="o">//</span><span class="nv">gnu</span>.<span class="nv">org</span><span class="o">/</span><span class="nv">licenses</span><span class="o">/</span><span class="nv">gpl</span>.<span class="nv">html</span><span class="o">&gt;</span>
<span class="nv">This</span> <span class="nv">is</span> <span class="nv">free</span> <span class="nv">software</span>: <span class="nv">you</span> <span class="nv">are</span> <span class="nv">free</span> <span class="nv">to</span> <span class="nv">change</span> <span class="nv">and</span> <span class="nv">redistribute</span> <span class="nv">it</span>.
<span class="nv">There</span> <span class="nv">is</span> <span class="nv">NO</span> <span class="nv">WARRANTY</span>, <span class="nv">to</span> <span class="nv">the</span> <span class="nv">extent</span> <span class="nv">permitted</span> <span class="nv">by</span> <span class="nv">law</span>.  <span class="nv">Type</span> <span class="s2">&quot;</span><span class="s">show copying</span><span class="s2">&quot;</span>
<span class="nv">and</span> <span class="s2">&quot;</span><span class="s">show warranty</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="nv">details</span>.
<span class="nv">This</span> <span class="nv">GDB</span> <span class="nv">was</span> <span class="nv">configured</span> <span class="nv">as</span> <span class="s2">&quot;</span><span class="s">x86_64-redhat-linux-gnu</span><span class="s2">&quot;</span>.
<span class="k">For</span> <span class="nv">bug</span> <span class="nv">reporting</span> <span class="nv">instructions</span>, <span class="nv">please</span> <span class="nv">see</span>:
<span class="o">&lt;</span><span class="nv">http</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">gnu</span>.<span class="nv">org</span><span class="o">/</span><span class="nv">software</span><span class="o">/</span><span class="nv">gdb</span><span class="o">/</span><span class="nv">bugs</span><span class="o">/&gt;</span>...
<span class="nv">Reading</span> <span class="nv">symbols</span> <span class="nv">from</span> <span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">traffic_server</span>...<span class="nv">Reading</span> <span class="nv">symbols</span> <span class="nv">from</span> <span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">lib</span><span class="o">/</span><span class="nv">debug</span><span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">traffic_server</span>.<span class="nv">debug</span>...<span class="nv">done</span>.
<span class="nv">done</span>.
<span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="k">break</span> <span class="nv">HttpSM</span>::<span class="nv">set_next_state</span>
<span class="nv">Breakpoint</span> <span class="mi">1</span> <span class="nv">at</span> <span class="mi">0</span><span class="nv">x151510</span>: <span class="nv">file</span> <span class="nv">HttpSM</span>.<span class="nv">cc</span>, <span class="nv">line</span> <span class="mi">6940</span>.
<span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">run</span> <span class="o">--</span><span class="nv">bind_stdout</span> <span class="o">/</span><span class="nv">var</span><span class="o">/</span><span class="nv">log</span><span class="o">/</span><span class="nv">trafficserver</span><span class="o">/</span><span class="nv">traffic</span>.<span class="nv">out</span> <span class="o">--</span><span class="nv">bind_stderr</span> <span class="o">/</span><span class="nv">var</span><span class="o">/</span><span class="nv">log</span><span class="o">/</span><span class="nv">trafficserver</span><span class="o">/</span><span class="nv">traffic</span>.<span class="nv">out</span> <span class="o">--</span><span class="nv">httpport</span> <span class="mi">80</span>:<span class="nv">fd</span><span class="o">=</span><span class="mi">9</span>
<span class="nv">Starting</span> <span class="nv">program</span>: <span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">traffic_server</span> <span class="o">--</span><span class="nv">bind_stdout</span> <span class="o">/</span><span class="nv">var</span><span class="o">/</span><span class="nv">log</span><span class="o">/</span><span class="nv">trafficserver</span><span class="o">/</span><span class="nv">traffic</span>.<span class="nv">out</span> <span class="o">--</span><span class="nv">bind_stderr</span> <span class="o">/</span><span class="nv">var</span><span class="o">/</span><span class="nv">log</span><span class="o">/</span><span class="nv">trafficserver</span><span class="o">/</span><span class="nv">traffic</span>.<span class="nv">out</span> <span class="o">--</span><span class="nv">httpport</span> <span class="mi">80</span>:<span class="nv">fd</span><span class="o">=</span><span class="mi">9</span>
[<span class="nv">Thread</span> <span class="nv">debugging</span> <span class="nv">using</span> <span class="nv">libthread_db</span> <span class="nv">enabled</span>]
<span class="nv">Using</span> <span class="nv">host</span> <span class="nv">libthread_db</span> <span class="nv">library</span> <span class="s2">&quot;</span><span class="s">/lib64/libthread_db.so.1</span><span class="s2">&quot;</span>.
<span class="nv">traffic_server</span>: <span class="nv">using</span> <span class="nv">root</span> <span class="nv">directory</span> <span class="s1">&#39;</span><span class="s">/usr</span><span class="s1">&#39;</span>
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7ffff3bde700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19929</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7ffff1249700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19930</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7ffff1047700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19931</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7ffff0a3c700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19932</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffebefe700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19933</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffebcfc700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19934</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffebafa700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19935</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeb8f8700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19936</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeb6f6700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19937</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeb4f4700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19938</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeb2f2700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19939</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeb0f0700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19940</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffeac5d700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19941</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffea95a700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19942</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffea859700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19943</span><span class="ss">)</span>]
[<span class="nv">New</span> <span class="nv">Thread</span> <span class="mi">0</span><span class="nv">x7fffea657700</span> <span class="ss">(</span><span class="nv">LWP</span> <span class="mi">19944</span><span class="ss">)</span>]
</pre></div>


<p>ここで別の端末で</p>
<div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">sv</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">33</span><span class="p">.</span><span class="mi">131</span><span class="o">/</span>
</pre></div>


<p>を実行しました。</p>
<p><code>HttpSM</code> というクラス名は <code>Http State Machine</code> の略と思われます。 HTTP を処理する状態遷移マシンになっています。以下のセッションでは HttpSM クラスの t_state メンバ変数の next_action を表示して、状態の遷移を確認してみました。</p>
<div class="highlight"><pre><span></span><span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="k">where</span><span class="w"></span>
<span class="n">#0</span><span class="w">  </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="n">#1</span><span class="w">  </span><span class="mh">0x000055555569aa96</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">state_read_client_request_header</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">data</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">771</span><span class="w"></span>
<span class="n">#2</span><span class="w">  </span><span class="mh">0x00005555556a7600</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">main_handler</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">data</span><span class="o">=</span><span class="mh">0x7fffe0017e38</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">2561</span><span class="w"></span>
<span class="n">#3</span><span class="w">  </span><span class="mh">0x00005555556a0f13</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">state_api_callout</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">data</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">1464</span><span class="w"></span>
<span class="n">#4</span><span class="w">  </span><span class="mh">0x00005555556a19a8</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">do_api_callout</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">391</span><span class="w"></span>
<span class="n">#5</span><span class="w">  </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">state_add_to_list</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">418</span><span class="w"></span>
<span class="n">#6</span><span class="w">  </span><span class="mh">0x00005555556a719b</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">attach_client_session</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">,</span><span class="w"> </span><span class="n">client_vc</span><span class="o">=</span><span class="mh">0x555556592d40</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_reader</span><span class="o">=</span><span class="mh">0x555556575ea8</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">544</span><span class="w"></span>
<span class="n">#7</span><span class="w">  </span><span class="mh">0x0000555555682ec5</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpClientSession</span><span class="p">:</span><span class="err">:</span><span class="n">new_transaction</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x555556592d40</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpClientSession</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">141</span><span class="w"></span>
<span class="n">#8</span><span class="w">  </span><span class="mh">0x000055555565e901</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">ProxyClientSession</span><span class="p">:</span><span class="err">:</span><span class="n">state_api_callout</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x555556592d40</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="n">ProxyClientSession</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">123</span><span class="w"></span>
<span class="n">#9</span><span class="w">  </span><span class="mh">0x00005555556824b2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpClientSession</span><span class="p">:</span><span class="err">:</span><span class="n">new_connection</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x555556592d40</span><span class="p">,</span><span class="w"> </span><span class="n">new_vc</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">iobuf</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">reader</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">backdoor</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpClientSession</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">220</span><span class="w"></span>
<span class="n">#10</span><span class="w"> </span><span class="mh">0x000055555567d969</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">HttpSessionAccept</span><span class="p">:</span><span class="err">:</span><span class="n">accept</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x55555621cab0</span><span class="p">,</span><span class="w"> </span><span class="n">netvc</span><span class="o">=</span><span class="mh">0x7fffe0017d20</span><span class="p">,</span><span class="w"> </span><span class="n">iobuf</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">reader</span><span class="o">=</span><span class="mh">0x555556575ea8</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSessionAccept</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">74</span><span class="w"></span>
<span class="n">#11</span><span class="w"> </span><span class="mh">0x000055555565e683</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">ProtocolProbeTrampoline</span><span class="p">:</span><span class="err">:</span><span class="n">ioCompletionEvent</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x5555563bc880</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">edata</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">ProtocolProbeSessionAccept</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">123</span><span class="w"></span>
<span class="n">#12</span><span class="w"> </span><span class="mh">0x000055555581de76</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">handleEvent</span><span class="w"> </span><span class="p">(</span><span class="k">data</span><span class="o">=</span><span class="mh">0x7fffe0017e38</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">at</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">iocore</span><span class="o">/</span><span class="n">eventsystem</span><span class="o">/</span><span class="n">I_Continuation</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="mi">153</span><span class="w"></span>
<span class="n">#13</span><span class="w"> </span><span class="n">read_signal_and_update</span><span class="w"> </span><span class="p">(</span><span class="n">vc</span><span class="o">=</span><span class="mh">0x7fffe0017d20</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">UnixNetVConnection</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">150</span><span class="w"></span>
<span class="n">#14</span><span class="w"> </span><span class="n">read_from_net</span><span class="w"> </span><span class="p">(</span><span class="n">nh</span><span class="o">=</span><span class="mh">0x7ffff31e0b90</span><span class="p">,</span><span class="w"> </span><span class="n">vc</span><span class="o">=</span><span class="mh">0x7fffe0017d20</span><span class="p">,</span><span class="w"> </span><span class="n">thread</span><span class="o">=</span><span class="mh">0x7ffff31dd010</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">UnixNetVConnection</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">390</span><span class="w"></span>
<span class="n">#15</span><span class="w"> </span><span class="mh">0x000055555580e6b0</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">NetHandler</span><span class="p">:</span><span class="err">:</span><span class="n">mainNetEvent</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7ffff31e0b90</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">UnixNet</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">518</span><span class="w"></span>
<span class="n">#16</span><span class="w"> </span><span class="mh">0x000055555583c2d0</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">handleEvent</span><span class="w"> </span><span class="p">(</span><span class="k">data</span><span class="o">=</span><span class="mh">0x555556172dc0</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">I_Continuation</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="mi">153</span><span class="w"></span>
<span class="n">#17</span><span class="w"> </span><span class="nl">EThread</span><span class="p">:</span><span class="err">:</span><span class="n">process_event</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="n">this</span><span class="nv">@entry</span><span class="o">=</span><span class="mh">0x7ffff31dd010</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">=</span><span class="mh">0x555556172dc0</span><span class="p">,</span><span class="w"> </span><span class="n">calling_code</span><span class="o">=</span><span class="n">calling_code</span><span class="nv">@entry</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">UnixEThread</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">128</span><span class="w"></span>
<span class="n">#18</span><span class="w"> </span><span class="mh">0x000055555583cdab</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">EThread</span><span class="p">:</span><span class="err">:</span><span class="k">execute</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7ffff31dd010</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">UnixEThread</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">252</span><span class="w"></span>
<span class="n">#19</span><span class="w"> </span><span class="mh">0x000055555560af60</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="p">(</span><span class="n">argv</span><span class="o">=&lt;</span><span class="n">optimized</span><span class="w"> </span><span class="k">out</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">Main</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">1918</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_READ_REQUEST_HDR</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_PRE_REMAP</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_REMAP_REQUEST</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_POST_REMAP</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_CACHE_LOOKUP</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_READ_CACHE_HDR</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_CACHE_LOOKUP_COMPLETE</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_DNS_LOOKUP</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_API_OS_DNS</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_CACHE_ISSUE_WRITE</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_ORIGIN_SERVER_OPEN</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="n">Breakpoint</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">HttpSM</span><span class="p">:</span><span class="err">:</span><span class="n">set_next_state</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="mh">0x7fffea0d0080</span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">HttpSM</span><span class="p">.</span><span class="nl">cc</span><span class="p">:</span><span class="mi">6940</span><span class="w"></span>
<span class="mi">6940</span><span class="w">    </span><span class="err">{</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">t_state</span><span class="p">.</span><span class="n">next_action</span><span class="w"></span>
<span class="err">$</span><span class="mi">12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">HttpTransact</span><span class="p">:</span><span class="err">:</span><span class="n">SM_ACTION_SERVER_READ</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="n">Continuing</span><span class="p">.</span><span class="w"></span>
</pre></div>


<h2>gdb でよく使うコマンドのメモ</h2>
<p>ブレークポイント一覧表示あたりをよく忘れるのでメモ。ググってみると <a href="http://wombat.cc.tsukuba.ac.jp/~furuse/jikken/text-07/text-07.html">マイクロデータベース管理システムの実装</a> にわかりやすくまとまっていました。</p>
<ul>
<li>b: break。ブレークポイント設定。b の後に「クラス名::メソッド名」、「関数名」、「ファイル名:行番号」のように止めたい箇所を指定します。</li>
<li>i b: info breakpointsの略。ブレークポイント一覧表示。</li>
<li>del [ブレークポイント番号]。ブレークポイント削除。番号を省略すると全て削除。</li>
<li>where: ブレークポイントで止まったときにコールスタックを表示します。</li>
<li>p: print。ブレークポイントで止まったときに変数の値を表示します。</li>
<li>c: continue。実行継続。ブレークポイントを設定していればそこで止まります。</li>
<li>n: next。ステップオーバー。関数呼び出しの際には中に入らずにステップ実行します。</li>
<li>s: step。ステップイン。関数呼び出しの際にの中に入ってステップ実行します。</li>
<li>q: quit。実行終了。まだ実行中だと <code>Quit anyway? (y or n)</code> と聞かれるので y を押して終了します。</li>
</ul>
<p>ブレークポイントで止まっていない場合も、実行中に Ctrl-C で gdb のプロンプトが出るので、そこで上記のコマンドを実行できます。その後 c で実行再開できます。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is a custom version based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53263855-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>