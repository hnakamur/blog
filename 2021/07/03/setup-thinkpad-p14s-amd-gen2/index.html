<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja-jp" lang="ja-jp">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.84.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>ThinkPad P14s AMD Gen 2 のセットアップ &middot; hnakamur&#39;s blog</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://hnakamur.github.io/blog/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://hnakamur.github.io/blog/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://hnakamur.github.io/blog/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://hnakamur.github.io/blog/css/copy-button.css">
  <link type="text/css" rel="stylesheet" href="https://hnakamur.github.io/blog/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://hnakamur.github.io/blog/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://hnakamur.github.io/blog/favicon.png">

  
  


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53263855-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53263855-1');
</script>



</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://hnakamur.github.io/blog/"><h1>hnakamur&#39;s blog</h1></a>
      <p class="lead">
       my tech memo 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://hnakamur.github.io/blog/"> blog home </a></li><li><a href="https://github.com/hnakamur"> github @hnakamur </a></li><li><a href="https://twitter.com/hnakamur2"> twitter @hnakamur2 </a></li>
      </ul>
    </nav>

    <p>powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://pages.github.com/">GitHub Pages</a></p>
    <p>&copy; 2021. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>ThinkPad P14s AMD Gen 2 のセットアップ</h1>
  <time datetime=2021-07-03T15:32:49&#43;0900 class="post-date">2021-07-03</time>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#構成">構成</a>
      <ul>
        <li><a href="#ramとssdは別途ヨドバシドットコムで購入">RAMとSSDは別途ヨドバシ・ドット・コムで購入</a></li>
      </ul>
    </li>
    <li><a href="#注文と発送">注文と発送</a></li>
    <li><a href="#windows-10-のプロダクトキー確認">Windows 10 のプロダクトキー確認</a></li>
    <li><a href="#ハードウェアキーボードレイアウトを英語に変更">ハードウェアキーボードレイアウトを英語に変更</a></li>
    <li><a href="#windows-10-クリーンインストール">Windows 10 クリーン・インストール</a>
      <ul>
        <li><a href="#リカバリーメディアをダウンロードしてusbメモリに書き込み">リカバリーメディアをダウンロードしてUSBメモリに書き込み</a></li>
        <li><a href="#メモリ増設とssd換装">メモリ増設とSSD換装</a></li>
        <li><a href="#リカバリーの実行">リカバリーの実行</a></li>
      </ul>
    </li>
    <li><a href="#windows-の初期セットアップ">Windows の初期セットアップ</a></li>
    <li><a href="#windows-の各種設定">Windows の各種設定</a>
      <ul>
        <li><a href="#キーボードを英語配列に変更">キーボードを英語配列に変更</a></li>
        <li><a href="#ctrl--space-で-ime-オンオフ-の設定">Ctrl + Space で IME オン/オフ の設定</a></li>
        <li><a href="#タッチパッドの設定">タッチパッドの設定</a></li>
        <li><a href="#ディスプレイの設定">ディスプレイの設定</a></li>
        <li><a href="#電源とスリープ">電源とスリープ</a></li>
        <li><a href="#キーボードの-ctrl-と-capslock-入れ替え">キーボードの Ctrl と CapsLock 入れ替え</a></li>
      </ul>
    </li>
  </ul>
</nav>
  <h2 id="はじめに">はじめに</h2>
<p>購入した ThinkPad P14s AMD Gen 2 が届いたのでセットアップのメモです。</p>
<h2 id="構成">構成</h2>
<p><a href="https://www.lenovo.com/jp/ja/notebooks/thinkpad/p-series/P14s-AMD-G2/p/22WSP144SA2">ThinkPad P14s AMD Gen 2 | レノボジャパン</a></p>
<ul>
<li>構成内容: ThinkPad P14s Gen 2 AMD</li>
<li>製品番号: 21A0CTO1WWJAJP3</li>
<li>単価(税込): 134,618 円</li>
<li>Configuration Details
<ul>
<li>AMD Ryzen 7 PRO 5850U (1.90GHz, 12MB)</li>
<li>Windows 10 Pro 64bit - 日本語版</li>
<li>16GB DDR4 3200MHz (オンボード)</li>
<li>128GB ソリッドステートドライブ (M.2 2242, PCIe-NVMe)</li>
<li>14.0型FHD液晶(1920x1080) IPS、400nit、72%NTSC、マルチタッチ非対応</li>
<li>ブラック</li>
<li>なし</li>
<li>内蔵グラフィックス</li>
<li>IR &amp; 720p HDカメラ(マイクロホン付)</li>
<li>指紋センサーあり (ブラック)</li>
<li>英語キーボード</li>
<li>Wi-Fi 6対応 (IEEE802.11ax/ac/a/b/g/n準拠) (2x2) +Bluetooth</li>
<li>TPMあり(TCG V2.0準拠，ハードウェアチップ搭載)</li>
<li>BIOS Absolute有効</li>
<li>3セル リチウムイオンバッテリー (50Wh)</li>
<li>65W ACアダプター (2ピン)(USB Type-C)</li>
<li>14.0型FHD液晶(1920x1080)IPS、400nit、72%NTSC、マルチタッチ非対応、IR&amp;720p HDカメラ、マイク、WLAN、WWAN非対応、FreeSync</li>
<li>日本語</li>
<li>なし</li>
<li>1年間 引き取り修理</li>
</ul>
</li>
</ul>
<h3 id="ramとssdは別途ヨドバシドットコムで購入">RAMとSSDは別途ヨドバシ・ドット・コムで購入</h3>
<ul>
<li>RAM CT32G4SFD832A [32GB DDR4 3200 MT/s PC4-25600 CL22 DR x8 Unbuffered SODIMM 260pin]
<ul>
<li>単価(税込): 21,180 円</li>
</ul>
</li>
<li>SSD WDS100T2B0C [バルクSSD WD SN550シリーズ 1TB]
<ul>
<li>単価(税込): 14,920 円</li>
</ul>
</li>
</ul>
<h2 id="注文と発送">注文と発送</h2>
<ul>
<li>2021-06-19 注文</li>
<li>2021-06-28 発送</li>
<li>2021-07-03 到着</li>
</ul>
<h2 id="windows-10-のプロダクトキー確認">Windows 10 のプロダクトキー確認</h2>
<p><a href="https://www.quora.com/How-can-I-retrieve-my-Windows-10-product-key-from-my-Lenovos-and-HPs-laptop">(1) How can I retrieve my Windows 10 product key from my Lenovo&rsquo;s and HP&rsquo;s laptop? - Quora</a></p>
<p>管理者権限でコマンドプロンプトまたはパワーシェルを開いて以下のコマンドを実行。</p>
<pre><code>wmic path SoftwareLicensingService get OA3xOriginalProductKey
</code></pre><p>表示されたプロダクトキーはいつも使っているパスワードマネージャ KeePassXC に登録して管理。</p>
<h2 id="ハードウェアキーボードレイアウトを英語に変更">ハードウェアキーボードレイアウトを英語に変更</h2>
<p>初期セットアップのときに設定を間違えたのか、キーボードレイアウトが「日本語キーボード(106/109キー)」になってしまっていました。</p>
<p><a href="https://hamachan.info/win10-win-ekeybord/">英語キーボードと日本語キーボードの切り替え | Windows 10 | 初心者のためのOffice講座</a> を参考に英語に切り替え。Windowsの再起動が必要です。</p>
<ol>
<li>Windows キー + i を押して設定画面を表示</li>
<li>「時刻と言語」を選択</li>
<li>左のメニューの「言語」を選択</li>
<li>「優先する言語」の一覧の「日本語」を選択し「オプション」ボタンを押す</li>
<li>ハーソウェアキーボードレイアウトの「レイアウトを変更する」ボタンを押す</li>
<li>「英語キーボード(101/102キー)」を選択して「今すぐ再起動する」ボタンを押す　</li>
</ol>
<h2 id="windows-10-クリーンインストール">Windows 10 クリーン・インストール</h2>
<p><a href="https://support.lenovo.com/jp/ja/solutions/ht103617-clean-install-of-windows-10-on-thinkpad-and-lenovo-lavie-computers">ThinkPad および Lenovo LaVie コンピューター上での Windows 10 のクリーン・インストール - Lenovo Support JP</a> に BIOS を最新にするよう書かれていました。</p>
<p><a href="http://www.lenovo.com/support">Lenovo サポート Web サイト</a> から該当の機種の最新の BIOS をダウンロードしてインストールすれば良いとのことです。</p>
<p>サポート Web サイトにアクセスして、「製品グループを選択する」のページの「PC」の「製品を検出する」を押してみると <a href="https://support.lenovo.com/ro/ja/solutions/ht104055">Lenovo Service Bridge: 自動的にシステムタイプとシリアル番号を検出 - Lenovo Support RO</a> のインストールのダイアログがブラウザ内に表示されました。</p>
<p>一方 Windows のスタートメニューを見てみると <a href="https://support.lenovo.com/jp/ja/solutions/hf003321-lenovo-vantage-for-enterprise">Commercial Vantage（企業向け） - Lenovo Support JP</a>  というアプリケーションがインストール済みになっていました。</p>
<p>そこで Lenovo Service Bridge は使わずに Commercial Vantage (以下 Vantage と略します)のほうを使うことにして、そちらでシステムの更新を行いました。</p>
<p>ちなみに Vantage では機種名は ThinkPad P14s Gen 2a という表示になっていました。</p>
<p>Vantage で表示される BIOS バージョンは R1MET35W 1.05 でした。</p>
<p><a href="http://www.lenovo.com/support">Lenovo サポート Web サイト</a> で「製品グループを選択する」のページの「PC」の「PC製品サポートへ」を押し、検索欄に「ThinkPad P14s」と入力し「ThinkPad P14s Gen 2 (マシンタイプ 21A0,21A1) ノートブック」を選択すると <a href="https://pcsupport.lenovo.com/jp/ja/products/laptops-and-netbooks/thinkpad-p-series-laptops/thinkpad-p14s-gen-2-type-21a0-21a1/?linkTrack=Homepage%3ABody_Search%20Products&amp;searchType=3&amp;keyWordSearch=ThinkPad%20P14s%20Gen%202%20%28%E3%83%9E%E3%82%B7%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%97%2021A0,%2021A1%29%20%E3%83%8E%E3%83%BC%E3%83%88%E3%83%96%E3%83%83%E3%82%AF">laptops and netbooks :: thinkpad p series laptops :: thinkpad p14s gen 2 type 21a0 21a1 - Lenovo Support JP</a> が表示されました。</p>
<p>左の「ドライバーとソフトウェア」を選んで右で「BIOS」を選んでバージョンを確認すると 1.05 だったので最新になっていることが確認できました。</p>
<h3 id="リカバリーメディアをダウンロードしてusbメモリに書き込み">リカバリーメディアをダウンロードしてUSBメモリに書き込み</h3>
<ol>
<li><a href="https://pcsupport.lenovo.com/jp/ja/products/laptops-and-netbooks/thinkpad-p-series-laptops/thinkpad-p14s-gen-2-type-21a0-21a1/?linkTrack=Homepage%3ABody_Search%20Products&amp;searchType=3&amp;keyWordSearch=ThinkPad%20P14s%20Gen%202%20%28%E3%83%9E%E3%82%B7%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%97%2021A0,%2021A1%29%20%E3%83%8E%E3%83%BC%E3%83%88%E3%83%96%E3%83%83%E3%82%AF">laptops and netbooks :: thinkpad p series laptops :: thinkpad p14s gen 2 type 21a0 21a1 - Lenovo Support JP</a> で 左の「ドライバーとソフトウェア」を選んで右で「リカバリーメディアを注文する」タブを選択し、「クリックして続ける」ボタンを押します。</li>
<li>「資格を確認する」のステップで「シリアル番号を入力」の下の入力欄に Vantage で表示されているシリアル番号を入力します。</li>
<li>「注文する」のステップで「マシンタイプ」が「21A0」、「オペレーティングシステム」が「Win10PROx64」と正しく表示されたことを確認した上で、「国/地域」は「日本」、「OSの言語を選ぶ」は「Japanese」を選択し、保証ポリシーの左の「同意します」チェックボックスをオンにして「次へ」ボタンを押します。</li>
<li>「顧客情報を入力」のステップでは、名、性、メールアドレスを入力して「送信」ボタンを押します。</li>
</ol>
<p><a href="https://support.lenovo.com/documents/ht103653">https://support.lenovo.com/documents/ht103653</a> を開いて<a href="https://s3-us-west-2.amazonaws.com/ddstools.gdi.lenovo/win8/USBRecoveryCreator.exe">Lenovo USB Recovery Creator tool for Windows® 8 または以降 (例： Windows® 10)</a> (USBRecoveryCreator.exe という Windows の実行ファイル)をダウンロード、実行します。</p>
<p>実行すると Lenovo ID とパスワードを聞かれるので入力し、先程の注文を選択して、リカバリーメディアをダウンロードします。</p>
<p>ダウンロードが終わった時点で一旦終了して、ダウンロードしたディレクトリを <a href="https://sevenzip.osdn.jp/">圧縮・解凍ソフト 7-Zip</a> で無圧縮の zip 形式で固めて USBRecoveryCreator.exe とともにバックアップしました。</p>
<p>その後 16GBのUSBメモリを刺して再度 USBRecoveryCreator.exe を実行し、ダウンロードディクトリ内の <code>*.REM</code> ファイルを選択してUSBメモリにリカバリーディスクの内容を書き込みます。書き込んだ後の検証が結構時間がかかりますが、書き込みエラーがあるとまずいので終わるまでおとなしく待ちます。</p>
<h4 id="参考-usb-メモリにパーティションがあった場合に消す手順">参考: USB メモリにパーティションがあった場合に消す手順</h4>
<p>USBRecoveryCreator.exe でUSBメモリに書き込む前の話ですが、私が使おうとしていたUSBメモリはパーティションが複数作られていたので <a href="https://qiita.com/ktyubeshi/items/e71dd89722db85081284">USBメモリに出来た複数のパーティーションをWindowsの標準機能だけで削除する - Qiita</a> を参考に消しました。</p>
<ol>
<li>Windows キー + R を押して diskpart と入力して起動。</li>
<li><code>list disk</code> でディスク一覧を表示し USB メモリのディスク番号を確認。　</li>
<li><code>select disk ディスク番号</code> で対象のUSBメモリに切り替え。</li>
<li><code>detail disk</code> で選択に間違いがないことを確認。</li>
<li><code>clean</code> でパーティションを全て削除。</li>
<li><code>create parition primary</code> でプライマリパーティションを作成。</li>
<li><code>exit</code> で diskpart を終了。</li>
</ol>
<p>Windows キーを押して <code>disk manager</code> と入力して絞り込み「ハードディスク パーティションの作成とフォーマット」を選択して「ディスクの管理」を起動します。</p>
<p>USBメモリのパーティションをFAT32でフォーマットします。</p>
<h3 id="メモリ増設とssd換装">メモリ増設とSSD換装</h3>
<p><a href="https://www.youtube.com/watch?v=swlpvRz5w3g">Lenovo Thinkpad P14s (and T14, T15, P15s) Overview and Upgrade options - YouTube</a> と <a href="https://27kamimen.com/bunkai/">ThinkPadの分解はコツがあった！コツを知れば自分でメモリは簡単に交換できる</a> を参考に背面カバーを外します。</p>
<p>メモリはオンボードで16GBで増設スロット1つに32GBを追加します。</p>
<p>SSD は128GB のを 1TB に換装します。
SSD を止めているネジと金具を外した後 128GB のSSDを外し、1TBのSSDをつけてネジ止めします。元のSSDと金具は保管しておきます。</p>
<h3 id="リカバリーの実行">リカバリーの実行</h3>
<p>リカバリー用のUSBメモリを刺して電源を入れ、指示に従ってリカバリーを実行します。
終わるとUSBメモリを抜いて再起動するように言われるのでそうします。</p>
<p>ここから結構時間かかりました。</p>
<p>再起動後コマンドプロンプトがポコポコ開いて自動でコマンドが実行されるので終わるまで待ちます。待っていると再起動して Lenovo のロゴが出ている画面でいろいろセットアップが進みまた再起動されます。</p>
<p>その後 Windows の画面で Administrator のユーザーが表示されたかと思ったら [Windows Setup] というダイアログが出てさらにセットアップが続きます。ダイアログには以下のようなメッセージが出ていました。</p>
<pre><code>Windows is now setting up the following items:

AuditOne - DoWork
</code></pre><p>その後さらにセットアップと再起動が続いて、今度は Administrator で自動ログインしてセットアップが進み、さらに再起動がかかりました。</p>
<p>そしてまたコマンドプロンプトが開いてセットアップが続き、再起動がかかって続きが来ました (wpeinit の文字を見るのは2回めでループになってないかちょっと心配でしたが下記のダイアログで進んでいるとわかりました)。</p>
<p>今度は「Windows セットアップ」というダイアログで次のようなメッセージが出ました。</p>
<pre><code>次の項目を設定します:

AuditTwo - DoWork
AuditTwo - Finish
</code></pre><p>最初は <code>AuditTwo - DoWork</code> が太字になっていました。セットアップと再起動が進むうちに <code>AuditTwo - DoWork</code> の左に緑のチェックマーク✅ (実際は前景色と背景色が逆)が付き <code>AuditTwo - Finish</code> のほうが太字になりました。</p>
<h2 id="windows-の初期セットアップ">Windows の初期セットアップ</h2>
<p>長いリカバリが終わってついに「お住いの地域はこちらでよろしいですか？」のダイアログが出ました。ここから初期セットアップです。</p>
<p>途中は省略して、「アカウントを追加しましょう」では左下の「オフラインアカウント」を選択し、その次は「制限付きエクスペリエンス」を選択しました。</p>
<p>「このPCを使うのはだれですか？」でローカルで作成するアカウント名を入力します。</p>
<p>3つのセキュリティの質問は省略不可なので、選んだ選択肢とパスワードマネージャで生成したランダムな文字列を入力し、パスワードマネージャーに登録しました。</p>
<p>Windows Helloでは「顔認識の使用」か「指紋認証の使用」が選べますが、初めて指紋センサーつきの ThinkPad を買ったので指紋認証を設定しました。</p>
<p>「PIN のセットアップ」では「英字と記号を含める」をチェックしてパスワードマネージャで生成したランダムな文字列を設定しました。</p>
<p>「デバイスのプライバシー設定の選択」は全て「いいえ」にしました。</p>
<p>デバイス登録でメールアドレスを入力する箇所ではやはり英語キーボードなのに日本語配列になっていました。アットマーク <code>@</code> は <code>P</code> の右の <code>[</code> で入力しました。</p>
<h2 id="windows-の各種設定">Windows の各種設定</h2>
<h3 id="キーボードを英語配列に変更">キーボードを英語配列に変更</h3>
<p>上記の手順で英語配列に変更しました。</p>
<h3 id="ctrl--space-で-ime-オンオフ-の設定">Ctrl + Space で IME オン/オフ の設定</h3>
<ol>
<li>Windows キー + i を押して設定画面を表示</li>
<li>「時刻と言語」を選択</li>
<li>左のメニューの「言語」を選択</li>
<li>「優先する言語」の一覧の「日本語」を選択し「オプション」ボタンを押す</li>
<li>「キーボード」の一覧の「Microsoft IME」を選んで「オプション」ボタンを押す</li>
<li>「キーとタッチのカスタマイズ」を押す</li>
<li>「各キーに好みの機能を割り当てる」のスイッチをオンにする。</li>
<li>「Ctrl + Space」を「IME-オン/オフ」に変更する。</li>
</ol>
<h3 id="タッチパッドの設定">タッチパッドの設定</h3>
<ol>
<li>Windows キー + i を押して設定画面を表示</li>
<li>「デバイス」を選択</li>
<li>左で「タッチパッド」を選択</li>
<li>「カーソルの速度を変更する」を適宜調整</li>
<li>「右クリックするにはタッチパッドの右下を押します」をオフにする</li>
<li>「3本指ジェスチャ」と「4本指ジェスチャ」は「何もしない」に変更</li>
</ol>
<h3 id="ディスプレイの設定">ディスプレイの設定</h3>
<ol>
<li>デスクトップでポップアップメニューの「ディスプレイ設定」を選択</li>
<li>「テキスト、アプリ、その他の項目のサイズを変更する」を「100%」に変更</li>
</ol>
<h3 id="電源とスリープ">電源とスリープ</h3>
<p>スリープはなしに変更</p>
<h3 id="キーボードの-ctrl-と-capslock-入れ替え">キーボードの Ctrl と CapsLock 入れ替え</h3>
<p>BIOS に Fn と Ctrl の入れ替えという設定はありましたが、Ctrl と CapsLock 入れ替えはなかったので、いつも使ってるレジストリ設定を投入します。</p>
<p><a href="https://ascii.jp/elem/000/000/927/927191/">ASCII.jp：CtrlとCapsを入れ替え！　Windowsのキー配列をカスタマイズ (1/2)</a></p>
<p><a href="/blog/windows10_keyboard_swap_ctrl_caps.reg">windows10_keyboard_swap_ctrl_caps.reg</a> を名前をつけて保存して、エクスプローラで選んでポップアップメニューの「結合」を選んでレジストリに登録します。その後 Windows を再起動して反映します。</p>
<p>続く</p>

</div>


<script src="https://hnakamur.github.io/blog/js/copy-button.js"></script>
    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-53263855-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </body>
</html>
