<!DOCTYPE html>
<html lang="ja">
<head>
        <meta charset="utf-8" />
        <title>LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました</title>
        <link rel="stylesheet" href="../../../../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../../../../">hnakamur's blog at github </a></h1>
                <nav><ul>
                    <li class="active"><a href="../../../../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="../../../../2015/04/23/try-lxd-0.7-with-vagrant/" rel="bookmark"
           title="Permalink to LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました">LXD 0.7ではlxc execでシェルの対話操作もできるようになっていました</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-04-23T00:08:00+09:00">
                Published: 2015-04-23
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://hnakamur.github.io">Hiroaki Nakamura</a>
        </address>
<p>In <a href="../../../../category/blog.html">blog</a>.</p>
<p>tags: <a href="../../../../tag/lxd.html">lxd</a> </p>
</footer><!-- /.post-info -->      <h2>はじめに</h2>
<p><a href="/blog/2014/12/01/lxd-the-linux-container-daemon/">LXDを試してみた · hnakamur's blog at github</a>の記事を書いて以来、LXD触る時間を作れてなかったのですが、久々に試してみました。</p>
<p>今では<a href="https://github.com/lxc/lxd">lxc/lxd</a>にVagrantfileが同梱されているので、それを使うだけで簡単に試せます。</p>
<p>VirtualBox 4.3.26, Vagrant 1.7.2, OS X Yosemiteという環境で試しました。</p>
<h2>操作手順</h2>
<h3>VagrantでVMを起動</h3>
<p>まずOS X上で以下のコマンドを実行します。</p>
<div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span>
<span class="n">cd</span> <span class="n">lxd</span>
<span class="n">vagrant</span> <span class="n">up</span>
</pre></div>


<p><a href="https://github.com/lxc/lxd/blob/lxd-0.7/Vagrantfile">Vagrantfile</a>を見てみると、Vagrantのシェルプロビジョナでgoとlxdをインストールするようになっています。</p>
<p><a href="https://github.com/lxc/lxd/blob/lxd-0.7/scripts/vagrant/install-lxd.sh">lxd/install-lxd.sh at lxd-0.7 · lxc/lxd</a>を見てみると、<a href="https://github.com/lxc/lxd">lxdのREADME</a>と同様のセットアップ手順に加えてlxdをサービスとして登録して起動する処理まで含まれています。</p>
<h3>VMにログインしてlxcコマンドを試してみる</h3>
<p>以下のコマンドを実行してVMにログインします。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">ssh</span>
</pre></div>


<p>以降のコマンドはVM上で実行します。</p>
<p><code>lxc</code> と <code>lxd</code> にはPATHが通った状態になっていることを確認しました。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">lxc</span><span class="w"></span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">lxc</span><span class="w"></span>
<span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">lxd</span><span class="w"></span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">lxd</span><span class="w"></span>
</pre></div>


<p>バージョンを確認してみると、 <code>lxc</code>, <code>lxd</code> ともに0.7でした。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxd</span><span class="w"> </span><span class="c1">--version</span>
<span class="mf">0.7</span><span class="w"></span>
<span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxc</span><span class="w"> </span><span class="c1">--version</span>
<span class="mf">0.7</span><span class="w"></span>
</pre></div>


<p><a href="https://github.com/lxc/lxd#first-steps">lxdのREADMEのFirst steps</a>に添って、ubuntuとdebianのイメージを取得します。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">ubuntu</span> <span class="nn">trusty</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">ubuntu</span> <span class="o">--</span><span class="n">alias</span> <span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpsccxc1fa</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150420</span><span class="n">_03</span><span class="p">:</span><span class="mi">49</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpsccxc1fa</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150420</span><span class="n">_03</span><span class="p">:</span><span class="mf">49.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Image</span> <span class="n">imported</span> <span class="k">as</span><span class="p">:</span> <span class="n">c9176e837c0012d6d0eed221312ee9fc761765319701f57e65e63542ad9beade</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">ubuntu</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">/</span><span class="n">trusty</span>
</pre></div>


<p>debianのほうは最初コピペミスでaliasに2回同じ値を指定してしまってエラーになりましたが、再度実行すると成功しました。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">debian</span> <span class="nn">wheezy</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_d1gz0q6</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mi">42</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmp_d1gz0q6</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">wheezy</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mf">42.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Image</span> <span class="n">imported</span> <span class="k">as</span><span class="p">:</span> <span class="n">cd398814f6e4e1e50799ba8249b80aa3558e5b05edf71a996a174def87569ae5</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span>
<span class="n">Setup</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">410</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">367</span><span class="p">,</span> <span class="ow">in</span> <span class="n">import_lxc</span>
    <span class="n">setup_alias</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">fingerprint</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">330</span><span class="p">,</span> <span class="ow">in</span> <span class="n">setup_alias</span>
    <span class="n">lxd</span><span class="o">.</span><span class="n">aliases_create</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">fingerprint</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;scripts/lxd-images&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">83</span><span class="p">,</span> <span class="ow">in</span> <span class="n">aliases_create</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to create alias: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
<span class="ne">Exception</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">create</span> <span class="n">alias</span><span class="p">:</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span>
<span class="n">vagrant</span><span class="nd">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="p">:</span><span class="o">~/</span><span class="n">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span> <span class="n">scripts</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">images</span> <span class="kn">import</span> <span class="nn">lxc</span> <span class="nn">debian</span> <span class="nn">wheezy</span> <span class="nn">amd64</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span> <span class="o">--</span><span class="n">alias</span> <span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">key</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span> <span class="nb">list</span> <span class="k">for</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpeqkwuvfw</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">asc</span>
<span class="n">Downloading</span> <span class="n">the</span> <span class="n">image</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">images</span><span class="o">.</span><span class="n">linuxcontainers</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">wheezy</span><span class="o">/</span><span class="n">amd64</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mi">42</span><span class="o">/</span><span class="n">lxd</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Validating</span> <span class="n">the</span> <span class="n">GPG</span> <span class="n">signature</span> <span class="n">of</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">tmpeqkwuvfw</span><span class="o">/</span><span class="n">debian</span><span class="o">-</span><span class="n">wheezy</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="n">default</span><span class="o">-</span><span class="mi">20150419</span><span class="n">_22</span><span class="p">:</span><span class="mf">42.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span><span class="o">.</span><span class="n">asc</span>
<span class="n">This</span> <span class="n">image</span> <span class="ow">is</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">store</span><span class="o">.</span>
</pre></div>


<p>コンテナを起動します。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxc</span><span class="w"> </span><span class="n">launch</span><span class="w"> </span><span class="n">ubuntuCreating</span><span class="w"> </span><span class="n">container</span><span class="p">...</span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">container</span><span class="p">...</span><span class="n">done</span><span class="w"></span>
<span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxc</span><span class="w"> </span><span class="n">launch</span><span class="w"> </span><span class="n">debian</span><span class="w"> </span><span class="n">debian01</span><span class="w"></span>
<span class="n">Creating</span><span class="w"> </span><span class="n">container</span><span class="p">...</span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">container</span><span class="p">...</span><span class="n">done</span><span class="w"></span>
</pre></div>


<p>コンテナの一覧を表示してみます。ubuntuのほうはコンテナ名を指定しなかったので、自動で付けられています。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxc</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="n">NAME</span><span class="w">         </span><span class="o">|</span><span class="w">  </span><span class="k">STATE</span><span class="w">  </span><span class="o">|</span><span class="w">    </span><span class="n">IPV4</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">IPV6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">EPHEMERAL</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">preterhuman</span><span class="o">-</span><span class="n">araceli</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">10.0.3.188</span><span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">        </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">debian01</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="o">|</span><span class="w">            </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">        </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
</pre></div>


<p>debianのほうはIPアドレスが空になっていて、あれ？と思ったのですが、実行するタイミングが早すぎたようで、数秒立ってから再度実行するとアドレスが表示されました。</p>
<div class="highlight"><pre><span></span><span class="n">vagrant</span><span class="nv">@vagrant</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">trusty</span><span class="o">-</span><span class="mi">64</span><span class="err">:</span><span class="o">~/</span><span class="k">go</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">lxc</span><span class="o">/</span><span class="n">lxd</span><span class="err">$</span><span class="w"> </span><span class="n">lxc</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
<span class="o">|</span><span class="w">        </span><span class="n">NAME</span><span class="w">         </span><span class="o">|</span><span class="w">  </span><span class="k">STATE</span><span class="w">  </span><span class="o">|</span><span class="w">    </span><span class="n">IPV4</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">IPV6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">EPHEMERAL</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">preterhuman</span><span class="o">-</span><span class="n">araceli</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">10.0.3.188</span><span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">        </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">debian01</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">RUNNING</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">10.0.3.42</span><span class="w">  </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">        </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">---------------------+---------+------------+------+-----------+</span>
</pre></div>


<p>以前未実装だった <code>lxc shell</code> の代わりに <code>lxc exec</code> でコマンド実行やシェルでの対話操作ができるようになっていました。</p>
<p><code>lxc exec コンテナ名 コマンド 引数</code> のように指定すると、コンテナ内でコマンドを実行できます。</p>
<div class="highlight"><pre><span></span><span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="nv">ip</span> <span class="nv">a</span>
<span class="mi">1</span>: <span class="nv">lo</span>: <span class="o">&lt;</span><span class="nv">LOOPBACK</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span> <span class="nv">mtu</span> <span class="mi">65536</span> <span class="nv">qdisc</span> <span class="nv">noqueue</span> <span class="nv">state</span> <span class="nv">UNKNOWN</span>
    <span class="nv">link</span><span class="o">/</span><span class="nv">loopback</span> <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span> <span class="nv">brd</span> <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>
    <span class="nv">inet</span> <span class="mi">127</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">1</span><span class="o">/</span><span class="mi">8</span> <span class="nv">scope</span> <span class="nv">host</span> <span class="nv">lo</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
    <span class="nv">inet6</span> ::<span class="mi">1</span><span class="o">/</span><span class="mi">128</span> <span class="nv">scope</span> <span class="nv">host</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
<span class="mi">6</span>: <span class="nv">eth0</span>: <span class="o">&lt;</span><span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span> <span class="nv">mtu</span> <span class="mi">1500</span> <span class="nv">qdisc</span> <span class="nv">pfifo_fast</span> <span class="nv">state</span> <span class="nv">UP</span> <span class="nv">qlen</span> <span class="mi">1000</span>
    <span class="nv">link</span><span class="o">/</span><span class="nv">ether</span> <span class="mi">00</span>:<span class="mi">16</span>:<span class="mi">3</span><span class="nv">e</span>:<span class="mi">01</span>:<span class="nv">bd</span>:<span class="nv">a1</span> <span class="nv">brd</span> <span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
    <span class="nv">inet</span> <span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">3</span>.<span class="mi">42</span><span class="o">/</span><span class="mi">24</span> <span class="nv">brd</span> <span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">3</span>.<span class="mi">255</span> <span class="nv">scope</span> <span class="nv">global</span> <span class="nv">eth0</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
    <span class="nv">inet6</span> <span class="nv">fe80</span>::<span class="mi">216</span>:<span class="mi">3</span><span class="nv">eff</span>:<span class="nv">fe01</span>:<span class="nv">bda1</span><span class="o">/</span><span class="mi">64</span> <span class="nv">scope</span> <span class="nv">link</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span> <span class="nv">ip</span> <span class="nv">a</span>
<span class="mi">1</span>: <span class="nv">lo</span>: <span class="o">&lt;</span><span class="nv">LOOPBACK</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span> <span class="nv">mtu</span> <span class="mi">65536</span> <span class="nv">qdisc</span> <span class="nv">noqueue</span> <span class="nv">state</span> <span class="nv">UNKNOWN</span> <span class="nv">group</span> <span class="nv">default</span>
    <span class="nv">link</span><span class="o">/</span><span class="nv">loopback</span> <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span> <span class="nv">brd</span> <span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>:<span class="mi">00</span>
    <span class="nv">inet</span> <span class="mi">127</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">1</span><span class="o">/</span><span class="mi">8</span> <span class="nv">scope</span> <span class="nv">host</span> <span class="nv">lo</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
    <span class="nv">inet6</span> ::<span class="mi">1</span><span class="o">/</span><span class="mi">128</span> <span class="nv">scope</span> <span class="nv">host</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
<span class="mi">4</span>: <span class="nv">eth0</span>: <span class="o">&lt;</span><span class="nv">BROADCAST</span>,<span class="nv">MULTICAST</span>,<span class="nv">UP</span>,<span class="nv">LOWER_UP</span><span class="o">&gt;</span> <span class="nv">mtu</span> <span class="mi">1500</span> <span class="nv">qdisc</span> <span class="nv">pfifo_fast</span> <span class="nv">state</span> <span class="nv">UP</span> <span class="nv">group</span> <span class="nv">default</span> <span class="nv">qlen</span> <span class="mi">1000</span>
    <span class="nv">link</span><span class="o">/</span><span class="nv">ether</span> <span class="mi">00</span>:<span class="mi">16</span>:<span class="mi">3</span><span class="nv">e</span>:<span class="mi">5</span><span class="nv">e</span>:<span class="mi">6</span><span class="nv">c</span>:<span class="mi">79</span> <span class="nv">brd</span> <span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>:<span class="nv">ff</span>
    <span class="nv">inet</span> <span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">3</span>.<span class="mi">188</span><span class="o">/</span><span class="mi">24</span> <span class="nv">brd</span> <span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">3</span>.<span class="mi">255</span> <span class="nv">scope</span> <span class="nv">global</span> <span class="nv">eth0</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
    <span class="nv">inet6</span> <span class="nv">fe80</span>::<span class="mi">216</span>:<span class="mi">3</span><span class="nv">eff</span>:<span class="nv">fe5e</span>:<span class="mi">6</span><span class="nv">c79</span><span class="o">/</span><span class="mi">64</span> <span class="nv">scope</span> <span class="nv">link</span>
       <span class="nv">valid_lft</span> <span class="nv">forever</span> <span class="nv">preferred_lft</span> <span class="nv">forever</span>
</pre></div>


<p><code>uname -a</code> のようなコマンドを <code>lxc exec コンテナ名 コマンド 引数</code> のように指定するとlxcのオプションと解釈するようで、以下のエラーになりました。</p>
<div class="highlight"><pre><span></span><span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">error</span>: <span class="nv">flag</span> <span class="nv">provided</span> <span class="nv">but</span> <span class="nv">not</span> <span class="nv">defined</span>: <span class="o">-</span><span class="nv">a</span>
</pre></div>


<p>コンテナ名のあとに <code>--</code> を入れれば回避出来ました。</p>
<div class="highlight"><pre><span></span><span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">x86_64</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
</pre></div>


<p>ただ、原因は不明なのですが、何回か実行してみると、時々何も出力されないことがありました。</p>
<div class="highlight"><pre><span></span><span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">debian01</span> <span class="o">--</span> <span class="nv">uname</span> <span class="o">-</span><span class="nv">a</span>
<span class="nv">Linux</span> <span class="nv">debian01</span> <span class="mi">3</span>.<span class="mi">13</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="nv">generic</span> <span class="sc">#80</span><span class="o">-</span><span class="nv">Ubuntu</span> <span class="nv">SMP</span> <span class="nv">Thu</span> <span class="nv">Mar</span> <span class="mi">12</span> <span class="mi">11</span>:<span class="mi">16</span>:<span class="mi">15</span> <span class="nv">UTC</span> <span class="mi">2015</span> <span class="nv">x86_64</span> <span class="nv">GNU</span><span class="o">/</span><span class="nv">Linux</span>
</pre></div>


<p><code>lxc exec コンテナ名 /bin/bash</code> のようにコマンドにシェルを指定すると、コンテナ内でシェルが起動され対話操作が出来ました。ubuntuコンテナの実際の画面では <code>ls</code> の結果もカラー表示されていました。</p>
<div class="highlight"><pre><span></span><span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$ <span class="nv">lxc</span> <span class="k">exec</span> <span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span> <span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">bash</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">~</span># <span class="nv">ls</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">~</span># <span class="nv">pwd</span>
<span class="o">/</span><span class="nv">root</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">~</span># <span class="nv">cd</span> <span class="o">/</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">/</span># <span class="nv">ls</span> <span class="o">-</span><span class="nv">l</span>
<span class="nv">total</span> <span class="mi">60</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">55</span> <span class="nv">bin</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">10</span>  <span class="mi">2014</span> <span class="nv">boot</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">5</span> <span class="nv">root</span>   <span class="nv">root</span>     <span class="mi">420</span> <span class="nv">Apr</span> <span class="mi">22</span> <span class="mi">13</span>:<span class="mi">51</span> <span class="nv">dev</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>  <span class="mi">63</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">22</span> <span class="mi">13</span>:<span class="mi">51</span> <span class="nv">etc</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">3</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">55</span> <span class="nv">home</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>  <span class="mi">12</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">54</span> <span class="nv">lib</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">54</span> <span class="nv">lib64</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">media</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">10</span>  <span class="mi">2014</span> <span class="nv">mnt</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">opt</span>
<span class="nv">dr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span> <span class="mi">109</span> <span class="nv">nobody</span> <span class="nv">nogroup</span>    <span class="mi">0</span> <span class="nv">Apr</span> <span class="mi">22</span> <span class="mi">13</span>:<span class="mi">51</span> <span class="nv">proc</span>
<span class="nv">drwx</span><span class="o">------</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">root</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">9</span> <span class="nv">root</span>   <span class="nv">root</span>     <span class="mi">380</span> <span class="nv">Apr</span> <span class="mi">22</span> <span class="mi">13</span>:<span class="mi">51</span> <span class="nv">run</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">55</span> <span class="nv">sbin</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">srv</span>
<span class="nv">dr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>  <span class="mi">13</span> <span class="nv">nobody</span> <span class="nv">nogroup</span>    <span class="mi">0</span> <span class="nv">Apr</span> <span class="mi">22</span> <span class="mi">13</span>:<span class="mi">51</span> <span class="nv">sys</span>
<span class="nv">drwxrwxrwt</span>   <span class="mi">2</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">55</span> <span class="nv">tmp</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>  <span class="mi">10</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">usr</span>
<span class="nv">drwxr</span><span class="o">-</span><span class="nv">xr</span><span class="o">-</span><span class="nv">x</span>  <span class="mi">11</span> <span class="nv">root</span>   <span class="nv">root</span>    <span class="mi">4096</span> <span class="nv">Apr</span> <span class="mi">20</span> <span class="mi">03</span>:<span class="mi">53</span> <span class="nv">var</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">/</span># <span class="nv">ls</span>
<span class="nv">bin</span>   <span class="nv">dev</span>  <span class="nv">home</span>  <span class="nv">lib64</span>  <span class="nv">mnt</span>  <span class="nv">proc</span>  <span class="nv">run</span>   <span class="nv">srv</span>  <span class="nv">tmp</span>  <span class="nv">var</span>
<span class="nv">boot</span>  <span class="nv">etc</span>  <span class="nv">lib</span>   <span class="nv">media</span>  <span class="nv">opt</span>  <span class="nv">root</span>  <span class="nv">sbin</span>  <span class="nv">sys</span>  <span class="nv">usr</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">/</span># <span class="nv">pwd</span>
<span class="o">/</span>
<span class="nv">root</span>@<span class="nv">preterhuman</span><span class="o">-</span><span class="nv">araceli</span>:<span class="o">/</span># <span class="k">exit</span>
<span class="nv">vagrant</span>@<span class="nv">vagrant</span><span class="o">-</span><span class="nv">ubuntu</span><span class="o">-</span><span class="nv">trusty</span><span class="o">-</span><span class="mi">64</span>:<span class="o">~/</span><span class="nv">go</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">github</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">lxc</span><span class="o">/</span><span class="nv">lxd</span>$
</pre></div>


<h2>おわりに</h2>
<p>以前試した時に比べて、かなり進歩してますね。</p>
<p>ten_forwardさんのライブマイグレーションの記事とかも、今後試してみようと思います。</p>
<ul>
<li><a href="http://d.hatena.ne.jp/defiant/20150415/1429089615">lxd を使ったライブマイグレーション (1) - TenForwardの日記</a></li>
<li><a href="http://d.hatena.ne.jp/defiant/20150415/1429090896">lxd を使ったライブマイグレーション (2) - TenForwardの日記</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is a custom version based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53263855-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>