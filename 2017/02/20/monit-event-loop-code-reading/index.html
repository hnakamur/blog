<!DOCTYPE html>
<html lang="ja">
<head>
        <meta charset="utf-8" />
        <title>monitのイベントループのコードリーディング</title>
        <link rel="stylesheet" href="../../../../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../../../../">hnakamur's blog at github </a></h1>
                <nav><ul>
                    <li class="active"><a href="../../../../category/blog.html">blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="../../../../2017/02/20/monit-event-loop-code-reading/" rel="bookmark"
           title="Permalink to monitのイベントループのコードリーディング">monitのイベントループのコードリーディング</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-02-20T16:46:00+09:00">
                Published: 2017-02-20
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://hnakamur.github.io">Hiroaki Nakamura</a>
        </address>
<p>In <a href="../../../../category/blog.html">blog</a>.</p>
<p>tags: <a href="../../../../tag/monit.html">monit</a> <a href="../../../../tag/code-reading.html">code-reading</a> </p>
</footer><!-- /.post-info -->      <div class="section" id="id1">
<h2>はじめに</h2>
<p><a class="reference external" href="/blog/2017/02/20/monit-if-failed-url-code-reading/">monitのif failed urlのコードリーディング</a> からの続きです。</p>
</div>
<div class="section" id="event-post">
<h2>Event_post関数の実装</h2>
<p><a class="reference external" href="https://bitbucket.org/tildeslash/monit/src/97641b51c99226fbf8862797c8f5ec16ac68a18b/src/event.c?at=release-5-11-0&amp;fileviewer=file-view-default#event.c-123:222">src/event.c#L123-L222</a></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Post a new Event</span>
<span class="cm"> * @param service The Service the event belongs to</span>
<span class="cm"> * @param id The event identification</span>
<span class="cm"> * @param state The event state</span>
<span class="cm"> * @param action Description of the event action</span>
<span class="cm"> * @param s Optional message describing the event</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">Event_post</span><span class="p">(</span><span class="n">Service_T</span> <span class="n">service</span><span class="p">,</span> <span class="kt">long</span> <span class="n">id</span><span class="p">,</span> <span class="kt">short</span> <span class="n">state</span><span class="p">,</span> <span class="n">EventAction_T</span> <span class="n">action</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="p">...)</span> <span class="p">{</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">service</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">action</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_FAILED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span><span class="p">);</span>

  <span class="kt">va_list</span> <span class="n">ap</span><span class="p">;</span>
  <span class="n">va_start</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="n">Str_vcat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ap</span><span class="p">);</span>
  <span class="n">va_end</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span>

  <span class="n">Event_T</span> <span class="n">e</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">eventlist</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Only first failed/changed event can initialize the queue for given event type, thus succeeded events are ignored until first error. */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">DEBUG</span><span class="p">(</span><span class="s">&quot;&#39;%s&#39; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
      <span class="n">free</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/* Initialize event list and add first event. The manadatory informations</span>
<span class="cm">     * are cloned so the event is as standalone as possible and may be saved</span>
<span class="cm">     * to the queue without the dependency on the original service, thus</span>
<span class="cm">     * persistent and managable across monit restarts */</span>
    <span class="n">NEW</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">collected</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">source</span> <span class="o">=</span> <span class="n">Str_dup</span><span class="p">(</span><span class="n">service</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">mode</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">mode</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">=</span> <span class="n">STATE_INIT</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
    <span class="n">service</span><span class="o">-&gt;</span><span class="n">eventlist</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="cm">/* Try to find the event with the same origin and type identification. Each service and each test have its own custom actions object, so we share actions object address to identify event source. */</span>
    <span class="k">do</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">==</span> <span class="n">action</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">collected</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

        <span class="cm">/* Shift the existing event flags to the left and set the first bit based on actual state */</span>
        <span class="n">e</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">e</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">|=</span> <span class="p">((</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>

        <span class="cm">/* Update the message */</span>
        <span class="n">FREE</span><span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
        <span class="n">e</span><span class="o">-&gt;</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">e</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="cm">/* Only first failed/changed event can initialize the queue for given event type, thus succeeded events are ignored until first error. */</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">DEBUG</span><span class="p">(</span><span class="s">&quot;&#39;%s&#39; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
        <span class="n">free</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="cm">/* Event was not found in the pending events list, we will add it.</span>
<span class="cm">       * The manadatory informations are cloned so the event is as standalone</span>
<span class="cm">       * as possible and may be saved to the queue without the dependency on</span>
<span class="cm">       * the original service, thus persistent and managable across monit</span>
<span class="cm">       * restarts */</span>
      <span class="n">NEW</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">=</span> <span class="n">id</span><span class="p">;</span>
      <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">collected</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">source</span> <span class="o">=</span> <span class="n">Str_dup</span><span class="p">(</span><span class="n">service</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">mode</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">mode</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">=</span> <span class="n">STATE_INIT</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
      <span class="n">e</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">service</span><span class="o">-&gt;</span><span class="n">eventlist</span><span class="p">;</span>
      <span class="n">service</span><span class="o">-&gt;</span><span class="n">eventlist</span> <span class="o">=</span> <span class="n">e</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">e</span><span class="o">-&gt;</span><span class="n">state_changed</span> <span class="o">=</span> <span class="n">Event_check_state</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">state</span><span class="p">);</span>

  <span class="cm">/* In the case that the state changed, update it and reset the counter */</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="o">-&gt;</span><span class="n">state_changed</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span>
    <span class="n">e</span><span class="o">-&gt;</span><span class="n">count</span><span class="o">++</span><span class="p">;</span>

  <span class="n">handle_event</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table><p><tt class="docutils literal">handle_event</tt> 関数の実装。
<a class="reference external" href="https://bitbucket.org/tildeslash/monit/src/97641b51c99226fbf8862797c8f5ec16ac68a18b/src/event.c?at=release-5-11-0&amp;fileviewer=file-view-default#event.c-605:655">src/event.c#L605-L655</a></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Handle the event</span>
<span class="cm"> * @param E An event</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">handle_event</span><span class="p">(</span><span class="n">Service_T</span> <span class="n">S</span><span class="p">,</span> <span class="n">Event_T</span> <span class="n">E</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">E</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">action</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">action</span><span class="o">-&gt;</span><span class="n">failed</span><span class="p">);</span>
  <span class="n">ASSERT</span><span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">action</span><span class="o">-&gt;</span><span class="n">succeeded</span><span class="p">);</span>

  <span class="cm">/* We will handle only first succeeded event, recurrent succeeded events</span>
<span class="cm">   * or insufficient succeeded events during failed service state are</span>
<span class="cm">   * ignored. Failed events are handled each time. */</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state_changed</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span> <span class="o">||</span> <span class="p">((</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">&amp;</span> <span class="mh">0x1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x1</span><span class="p">)))</span> <span class="p">{</span>
    <span class="n">DEBUG</span><span class="p">(</span><span class="s">&quot;&#39;%s&#39; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* In the case that the service state is initializing yet and error</span>
<span class="cm">     * occured, log it and exit. Succeeded events in init state are not</span>
<span class="cm">     * logged. Instance and action events are logged always with priority</span>
<span class="cm">     * info. */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">!=</span> <span class="n">STATE_INIT</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">state_map</span> <span class="o">&amp;</span> <span class="mh">0x1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_SUCCEEDED</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGEDNOT</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">==</span> <span class="n">Event_Instance</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">==</span> <span class="n">Event_Action</span><span class="p">)</span>
        <span class="n">LogInfo</span><span class="p">(</span><span class="s">&quot;&#39;%s&#39; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
      <span class="k">else</span>
        <span class="n">LogError</span><span class="p">(</span><span class="s">&quot;&#39;%s&#39; %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_INIT</span><span class="p">)</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_FAILED</span> <span class="o">||</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGED</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">!=</span> <span class="n">Event_Instance</span> <span class="o">&amp;&amp;</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span> <span class="o">!=</span> <span class="n">Event_Action</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// We are not interested in setting error flag for instance and action events</span>
      <span class="n">S</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">|=</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
      <span class="cm">/* The error hint provides second dimension for error bitmap and differentiates between failed/changed event states (failed=0, chaged=1) */</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">==</span> <span class="n">STATE_CHANGED</span><span class="p">)</span>
        <span class="n">S</span><span class="o">-&gt;</span><span class="n">error_hint</span> <span class="o">|=</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="n">S</span><span class="o">-&gt;</span><span class="n">error_hint</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">handle_action</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">action</span><span class="o">-&gt;</span><span class="n">failed</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">S</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">E</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
    <span class="n">handle_action</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="o">-&gt;</span><span class="n">action</span><span class="o">-&gt;</span><span class="n">succeeded</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="cm">/* Possible event state change was handled so we will reset the flag. */</span>
  <span class="n">E</span><span class="o">-&gt;</span><span class="n">state_changed</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is a custom version based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53263855-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>